/** @class ToolsController */
var ToolsController=function(){function e(e,t,o,n){this.items=[],this.$scope=e,this.$rootScope=t,this.$http=o,this.hasMoved=!1,this.base64=n,this.factor=1.01,this.angle=2,this.isSaving=!1,this.$scope.$=this,this.$scope.items=[],this.$scope.previewActive=!0,document.getElementById("fileupload").addEventListener("change",this.onFileSelect,!1),msg.on("confirmation-clicked",this.onSaveProjectConfirm,this),msg.on("project-loaded",this.projectLoaded,this),msg.on("update-items",this.updateItems,this),msg.on("disable-preview",this.disablePreview,this),msg.on("enable-preview",this.enablePreview,this),msg.on("update-text-btn-style",this.updateTextBtnStyle,this),msg.on("update-text-btn-weight",this.updateTextBtnWeight,this),msg.on("save-project-popup",this.saveProject,this),keys.bindKey(37,this.moveLeftObject,this),keys.bindKey(38,this.moveUpObject,this),keys.bindKey(39,this.moveRightObject,this),keys.bindKey(40,this.moveDownObject,this),keys.bindKey(27,this.closePopups,this),keys.bindKey(46,this.deleteObj,this),keys.bindKey(107,this.zoomIn,this),keys.bindKey(109,this.zoomOut,this),keys.bindKey(187,this.zoomIn,this),keys.bindKey(189,this.zoomOut,this),keys.bindKey(61,this.zoomIn,this),keys.bindKey(173,this.zoomOut,this),keys.bindKey(107,this.zoomIn,this),keys.bindKey(109,this.zoomOut,this),keys.bindCtrl(103,this.rotateCW,this),keys.bindCtrl(105,this.rotateCCW,this),keys.bindCtrl(38,this.moveObjectUp,this),keys.bindCtrl(40,this.moveObjectDown,this),keys.bindCtrl(46,this.deleteAllObj,this),keys.bindKey(27,this.onEscKeyClick,this),keys.bindKey(112,this.onTutorialClick,this)}return e.prototype.onEscKeyClick=function(){msg.send("on-esc-key-click")},e.prototype.share=function(e){msg.send("share-facebook-twitter",e)},e.prototype.onTutorialClick=function(){open("https://www.onlinelogomaker.com/tutorial","_blank")},e.prototype.removeObject=function(){msg.send("remove-object")},e.prototype.moveLeftObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,-2,0),this.moveStore(o,"left"))},e.prototype.moveUpObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,0,-2),this.moveStore(o,"up"))},e.prototype.moveRightObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,2,0),this.moveStore(o,"right"))},e.prototype.moveDownObject=function(e){var t=$canvas.getActiveDobj(),o=$cmd.history.length,n=window.event?event:e
void 0!==n&&null!==n&&n.preventDefault(),$(".dropdown").hasClass("open")||Object.keys($canvas.getActiveDobj()).length&&($cmd.run("move",t,0,2),this.moveStore(o,"down"))},e.prototype.moveStore=function(e,t){var o=!1
1===e&&1===$cmd.history.length||e>=1&&"move"===$cmd.history[e-1].name&&$cmd.history[e-1].args[0].id===$cmd.history[e].args[0].id&&("right"===t&&0===$cmd.history[e-1].args[2]&&$cmd.history[e-1].args[1]>0&&($cmd.history[e-1].args[1]+=2,o=!0),"left"===t&&0===$cmd.history[e-1].args[2]&&$cmd.history[e-1].args[1]<0&&($cmd.history[e-1].args[1]-=2,o=!0),"up"===t&&0===$cmd.history[e-1].args[1]&&$cmd.history[e-1].args[2]<0&&($cmd.history[e-1].args[2]-=2,o=!0),"down"===t&&0===$cmd.history[e-1].args[1]&&$cmd.history[e-1].args[2]>0&&($cmd.history[e-1].args[2]+=2,o=!0),!0===o&&($cmd.history.splice(e,1),$cmd.index--))},e.prototype.closePopups=function(e){msg.send("close-all-popups")},e.prototype.zoomIn=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj()),o=$canvas.getActiveDobj(),n={x:t.raw.getScaleX(),y:t.raw.getScaleY()},a={x:this.factor*o.raw.getScaleX(),y:this.factor*o.raw.getScaleY()}
this.$cmd.run("scale",o,n,a,o.raw.left,o.raw.top)},e.prototype.zoomOut=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj()),o=$canvas.getActiveDobj(),n={x:t.raw.getScaleX(),y:t.raw.getScaleY()},a={x:1/this.factor*obj.getScaleX(),y:1/this.factor*obj.getScaleY()}
this.$cmd.run("scale",o,n,a,o.raw.left,o.raw.top)},e.prototype.moveObjectUp=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t>0){$canvas.children.move(t,t-1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())+1)
break}},e.prototype.moveObjectDown=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t<$canvas.children.length-1){$canvas.children.move(t,t+1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())-1)
break}},e.prototype.disablePreview=function(e){var t=this
this.$scope.previewActive=!1,$("#preview-download-canvas").hide(),setTimeout(function(){t.$scope.$apply()},50)},e.prototype.enablePreview=function(e){var t=this
this.$scope.previewActive=!0,$("#preview-download-canvas").show(),setTimeout(function(){t.$scope.$apply()},50)},e.prototype.deleteAllObj=function(e){msg.send("remove-objects")},e.prototype.deleteObj=function(e){msg.send("remove-object"),this.$scope.items.length<=0&&msg.send("disable-preview")},e.prototype.renameObj=function(e){msg.send("open-popup","rename")},e.prototype.addSymobol=function(){msg.send("open-symbols")},e.prototype.addShape=function(){msg.send("open-shapes")},e.prototype.openLogoDesigner=function(){ga("send","event","App Click","Affiliate button clicked","Open Designer Website"),open("https://www.designsdesk.com","_blank")},e.prototype.addCard=function(){msg.send("open-cards")},e.prototype.rotateCW=function(){var e=$canvas.getActiveDobj()
$cmd.run("rotate",e,-this.angle)},e.prototype.rotateCCW=function(){var e=$canvas.getActiveDobj()
$cmd.run("rotate",e,this.angle)},e.prototype.duplicateObject=function(){$cmd.run("duplicate")},e.prototype.addText=function(){msg.send("open-popup"),msg.send("open-addtext")},e.prototype.uploadImage=function(){$("#fileupload").click(function(e){}),$("#fileupload").trigger("click")},e.prototype.downloadLogo=function(){msg.send("open-popup","downloadlogo")},e.prototype.new=function(){canvas.getObjects().length&&(msg.send("open-popup"),$("#new-modal").show())},e.prototype.previewProject=function(e){$(".preview")
msg.send("preview-project")},e.prototype.updateTextBtnWeight=function(e){"bold"===e?$("#id-bold-btn").addClass("input-active"):$("#id-bold-btn").removeClass("input-active")},e.prototype.updateTextBtnStyle=function(e){"italic"===e?$("#id-italic-btn").addClass("input-active"):$("#id-italic-btn").removeClass("input-active")},e.prototype.saveProject=function(){msg.send("close-popups"),$("#register-btn").text(Tools.translateText("register-btn")),$("#login-btn").text(Tools.translateText("login-btn")),$("#register-btn-2").text(Tools.translateText("register-btn")),$("#login-btn-2").text(Tools.translateText("login-btn")),msg.send("open-popup"),msg.send("save-project",!0,!1)},e.prototype.onBecomePremiumClick=function(){open(Tools.translateText("olm-become-premium-url"),"_blank")},e.prototype.copyToClipBoard=function(){$("#copy-clipboard-spinner").show(),setTimeout(function(){$("#copy-clipboard-spinner").hide()},1e3),document.getElementById("url-to-copy").select(),document.execCommand("Copy")},e.prototype.copyHtmlCodeClipBoard=function(){$("#copy-clipboard-spinner").show(),setTimeout(function(){$("#copy-clipboard-spinner").hide()},1e3),document.getElementById("copy-this-html").select(),document.execCommand("Copy"),ga("send","event","App Click","Copy HTML Code","BackLink code clicked")},e.prototype.registerButton=function(){msg.send("close-popups"),msg.send("open-popup"),$("#save-modal").show()},e.prototype.onSaveProjectConfirm=function(e){msg.send("save-project",e)},e.prototype.projectLoaded=function(){this.updateItems(),this.$scope.$apply()},e.prototype.updateItems=function(){this.$scope.items=$canvas.children
for(var e=$canvas.children,t=0;t<e.length;t++)if(e[t].isCard)return
this.$scope.items.length>0&&msg.send("enable-preview")},e.prototype.onFileSelect=function(e){for(var t,o=e.target.files,n=0;t=o[n];n++)if(t.type.match("image.*"))if(t.size>1048576)alert(Tools.translateText("image-size-too-big"))
else{var a=new FileReader
a.onload=function(e){return function(e){msg.send("add-image",e.target.result)}}(),a.readAsDataURL(t)}else alert(Tools.translateText("image-file-not-allowed"))
$("#fileupload").val("")},e}(),DrawingController=function(){function e(e){this.rootScope=this,this.$scope=e,this.$scope.$=this,canvas.isDrawingMode=!1,this.htmlPanel=$(".shape-tools"),msg.on("menu-click",this.onMenuClick,this)}return e.prototype.onMenuClick=function(e){this.isDrawingMode(!0),this.startDrawing(),"draw-shape"!=e&&(this.isDrawingMode(!1),this.stopDrawing())},e.prototype.isDrawingMode=function(e){canvas.isDrawingMode=e},e.prototype.startDrawing=function(){if(fabric.Object.prototype.transparentCorners=!1,this.isDrawingMode(!0),this.htmlPanel.show(),fabric.PatternBrush){new fabric.PatternBrush(canvas).getPatternSrc=function(){var e=fabric.document.createElement("canvas")
e.width=e.height=10
var t=e.getContext("2d")
return t.strokeStyle=this.color,t.lineWidth=5,t.beginPath(),t.moveTo(0,5),t.lineTo(10,5),t.closePath(),t.stroke(),e}}},e.prototype.stopDrawing=function(){this.isDrawingMode(!1),this.htmlPanel.hide()},e}(),SymbolsController=function(){function e(e,n){t=$(".object.add-shape"),o=$(".leftpane .list-group-item.add-symbol"),this.$scope=e,this.$scope.$=this,this.$http=n,this.selectedCategory=0,this.selectedCategoryName="",this.selectedSymbol=0,this.loadedSymbols=!1,this.allSymbols=[],this.allCalls=[],this.currentIndex=0,this.sucessIndex=0,this.search=!1,this.searchSymbols=[],this.categorySymbols=[],this.analyticsDelay=null,this.fullWord="",this.symbolsRootUrl="https://assets.onlinelogomaker.com/",this.selectedSymbolUrl="",_this=this,e.$watch("searchBox",function(t,o){if(null===t||void 0===t)e.$.search=!1
else if(""===t)e.$.search=!1,e.$.fillCategories(),e.$.selectedSymbolUrl=e.$.symbolsRootUrl+e.$.categories[e.$.selectedCategory].folder+"/",e.$.selectedCategoryName=e.$.categories[e.$.selectedCategory].name
else if(t.length>=3){var n=[]
_this.sucessIndex=0,_this.currentIndex=0,_this.abortCalls(),ga("send","event","App Click","Symbol Search",t.toString()),e.$.search=!0,e.$.selectedCategoryName="Search"
for(var a=0;a<e.$.allSymbols.length;a++)for(var s=0;s<e.$.allSymbols[a].arr.length;s++)if(null!=e.$.allSymbols[a].arr[s].name.match(t.toString().toLowerCase())){var i={folder:e.$.allSymbols[a].url,content:{name:e.$.allSymbols[a].arr[s].name}}
n.push(i)}else{_.filter(e.$.allSymbols[a].arr[s].synm,function(o){if(null!=o.match(t.toString().toLowerCase())){var i={folder:e.$.allSymbols[a].url,content:{name:e.$.allSymbols[a].arr[s].name}},r=n[n.length-1]
r?r.content.name!=i.content.name&&n.push(i):n.push(i)}})}e.$.searchSymbols=n}}),this.categories=data.categories,msg.on("on-esc-key-click",this.close,this),msg.on("open-symbols",this.open,this),msg.on("load-symbols",this.load,this),msg.on("reload-categories",this.reloadCategories,this),this.htmlString=svgImg.stringToHtml(),"1"===Tools.getQueryParameters("search")?$("#searchBox").show():$("#searchBox").hide(),$(document).mouseup(function(e){o.is(e.target)||t.show(),t.is(e.target)||0!==t.has(e.target).length||o.is(e.target)||$("#olm-search").is(":focus")||(this.search=!1,$("#olm-search").val(""),$(".leftpane .list-group-item.add-symbol").removeClass("active-left-side-tool"),t.hide())})}var t,o
return e.prototype.reloadCategories=function(){this.loadedSymbols=!1},e.prototype.load=function(){var e=this
if(!e.loadedSymbols)return new Promise(function(t,o){var n=Tools.QueryString()
n.lang||(n.lang="en"),window.lang&&(n.lang=window.lang),e.$http.get("https://assets.onlinelogomaker.com/symbols/"+n.lang+"/list_small.json?v="+Math.floor(Date.now()/1e3)).then(function(o){o.data.sort(function(e,t){return e.name>t.name?1:t.name>e.name?-1:0}),e.$scope.$.categories=o.data
for(var n=0;n<o.data.length;n++){var a={}
a.url=e.symbolsRootUrl+o.data[n].folder+"/",a.category=o.data[n].name,a.arr=[],e.allSymbols.url=e.symbolsRootUrl+o.data[n].folder+"/"
for(var s=0;s<o.data[n].content.length;s++)a.arr.push(o.data[n].content[s])
e.allSymbols.push(a)}e.selectedSymbolUrl=e.symbolsRootUrl+o.data[e.selectedCategory].folder+"/",e.selectedCategoryName=o.data[e.selectedCategory].name,e.selectedCategory=0,e.fillCategories(),e.loadedSymbols=!0,t(e.loadedSymbols)})})},e.prototype.fillCategories=function(){this.categorySymbols=[]
for(var e=0;e<this.categories[this.selectedCategory].content.length;e++){var t={},o=!0
t.folder=this.symbolsRootUrl+this.categories[this.selectedCategory].folder+"/",t.content=this.categories[this.selectedCategory].content[e]
for(var n=0;n<this.categorySymbols.length;n++)t.content.name==this.categorySymbols[n].content.name&&(o=!1)
o&&this.categorySymbols.push(t)}},e.prototype.getSymbolData=function(){var e=this,t=e.currentIndex
if(!(t>=this.getSelectedCategorySymbols().length))if(this.search){var o=this.searchSymbols[t].folder+this.searchSymbols[t].content.name
e.currentIndex++,$.ajax({url:o,type:"GET",beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){if(null!=t){var n=(new XMLSerializer).serializeToString(t),a=encodeURIComponent(n),s="data:image/svg+xml;charset=utf8,"+a
$("#currimg"+e.sucessIndex.toString()).attr("src",s),$("#currimg"+e.sucessIndex.toString()).attr("meta",o),e.sucessIndex++}},error:function(e,t){}})}else{var o=this.selectedSymbolUrl+this.getSelectedCategorySymbols()[t].content.name
e.currentIndex++,$.ajax({url:o,type:"GET",beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){if(null!=t){var n=(new XMLSerializer).serializeToString(t),a=encodeURIComponent(n),s="data:image/svg+xml;charset=utf8,"+a
$("#currimg"+e.sucessIndex.toString()).attr("src",s),$("#currimg"+e.sucessIndex.toString()).attr("meta",o),e.sucessIndex++}},error:function(e,t){}})}},e.prototype.abortCalls=function(){$.each(_this.allCalls,function(e,t){t.abort()})},e.prototype.onEscKeyClick=function(){this.search=!1,$("#olm-search").val(""),$(".leftpane .list-group-item.add-symbol").removeClass("active-left-side-tool"),this.close()},e.prototype.onSeeShapesClick=function(){$(".leftpane .list-group-item.add-symbol").removeClass("active-left-side-tool"),msg.send("close-popups"),this.abortCalls(),msg.send("open-shapes"),ga("send","event","App Click","See more shapes Click","Click")},e.prototype.open=function(){_this=this,$(".leftpane .list-group-item.add-symbol").addClass("active-left-side-tool"),this.loadedSymbols?t.show():(glassLoader.start(),this.load().then(function(){t.show(),glassLoader.stop()}))},e.prototype.close=function(){this.search=!1,this.abortCalls(),$("#olm-search").val(""),$(".leftpane .list-group-item.add-symbol").removeClass("active-left-side-tool"),t.hide()},e.prototype.getCategoryStyle=function(e){return e==this.selectedCategory?"category-item-selected":""},e.prototype.getSymbolStyle=function(e){return e==this.selectedSymbol?"symbol-item-selected":""},e.prototype.getSelectedCategorySymbols=function(){return this.search?this.searchSymbols:void 0!=this.categories[this.selectedCategory]?this.categorySymbols:null},e.prototype.onCategoryClick=function(e,t){this.selectedCategory=e,this.selectedSymbol=0,this.abortCalls(),this.selectedSymbolUrl="",this.currentIndex=0,this.sucessIndex=0,this.selectedSymbolUrl=this.symbolsRootUrl+this.categories[this.selectedCategory].folder+"/",this.selectedCategoryName=this.categories[this.selectedCategory].name,this.categories[this.selectedCategory].cssClass="",this.categories[this.selectedCategory].cssClass="category-item-selected",this.search=!1,this.fillCategories(),$("#categories-scroll").animate({scrollTop:0},"fast"),$("#olm-search").val("")},e.prototype.onSymbolClick=function(e,t){if($(".selected").removeClass("selected"),t.currentTarget.children.length>0)for(var o in t.currentTarget.children)t.currentTarget.children[o].className+=" selected"
this.selectedSymbol=e
var n=this.selectedSymbolUrl+this.getSelectedCategorySymbols()[this.selectedSymbol].content.name
ga("send","event","App Click","Symbol Select",n.toString())
var a={resp:!1}
msg.send("is-active-guided-tour",a),a.resp?(msg.send("add-symbol-guided-tour",this.selectedSymbolUrl+this.getSelectedCategorySymbols()[this.selectedSymbol]),$(".leftpane .list-group-item.add-symbol").removeClass("active-left-side-tool"),msg.send("close-popups")):this.onOkClick(),this.close()},e.prototype.onCancelClick=function(){$(".leftpane .list-group-item.add-symbol").removeClass("active-left-side-tool"),msg.send("close-popups")},e.prototype.onOkClick=function(){var e=$("#currimg"+this.selectedSymbol).attr("meta")
this.abortCalls(),msg.send("add-symbol",e),msg.send("close-popups")},e}(),PopupsController=function(){function e(e){this.$scope=e,msg.on("close-popups",this.close,this),msg.on("open-popups",this.open,this),msg.on("open-addtext",this.open,this),msg.on("open-invalid-user-pass",this.open,this),msg.on("open-popup",this.openPopup,this)}return e.prototype.open=function(){this.$scope.visible=!0},e.prototype.openPopup=function(e){this.$scope.visible=!0,msg.send("open-"+e)},e.prototype.close=function(){this.$scope.visible=!1},e}(),TransformController=function(){function e(t,o){this.$scope=t,this.$cmd=o,this.scaleTimeout,this.scaleTracker=[],this.precision=2,e.instance=this,canvas.on("object:moving",this.onObjectMove),canvas.on("object:scaling",this.onMouseChangeScale),canvas.on("object:selected",this.onObjectSelect),t.$watch("x",this.onChangePosition),t.$watch("y",this.onChangePosition),t.$watch("width",this.onChangeScale),t.$watch("height",this.onChangeScale),t.x=0,t.y=0,t.width=0,t.height=0}return e.prototype.onChangeScale=function(t){var o=e.instance,n=$canvas.getActiveDobj()
o.selected&&o.$scope.width&&o.$scope.height&&n.raw.set({scaleX:o.$scope.width/o.selected.width,scaleY:o.$scope.height/o.selected.height,originX:"center",originY:"center"})},e.prototype.onMouseChangeScale=function(t){var o=e.instance,n=$.extend(!0,{},$canvas.getActiveDobj()),a=$canvas.getActiveDobj(),s={x:n.raw.getScaleX(),y:n.raw.getScaleY(),l:n.raw.getLeft(),t:n.raw.getTop()},i={x:a.raw.getScaleX(),y:a.raw.getScaleY(),l:a.raw.getLeft(),t:a.raw.getTop()}
o.selected&&(o.scaleTracker.push(s),angular.isDefined(t)&&(clearTimeout(this.scaleTimeout),delete this.scaleTimeout,this.scaleTimeout=setTimeout(function(){o.$cmd.store("scale",a,o.scaleTracker[0],i),o.scaleTracker=[]},200)),setTimeout(function(){msg.send("draw-action-buttons",a.raw)},400))},e.prototype.onObjectSelect=function(t){e.instance.selected=t.target},e.prototype.selectionCleared=function(t){var o=e.instance
setTimeout(function(){o.$scope.$apply()},100)},e.prototype.onObjectMove=function(t){var o=e.instance
o.$scope.x=t.target.get("left").toFloat(o.precision),o.$scope.y=t.target.get("top").toFloat(o.precision),setTimeout(function(){},100)},e.prototype.onObjectScale=function(t){var o=e.instance
o.$scope.width=(t.target.get("width")*t.target.scaleX).toFloat(o.precision),o.$scope.height=(t.target.get("height")*t.target.scaleY).toFloat(o.precision),setTimeout(function(){},100),o.onChangeScale(o)},e.prototype.onChangePosition=function(){var t=e.instance
null!==t.selected&&void 0!==t.selected&&(t.selected.set("left",t.$scope.x),t.selected.set("top",t.$scope.y),canvas.renderAll())},e}(),ShapesController=function(){function e(e,n){t=$(".object.add-geometry"),o=$(".leftpane .list-group-item.add-geometry"),this.$scope=e,this.$scope.$=this,this.$http=n,this.selectedCategory=1,this.selectedCategoryName="",this.selectedSymbol=0,this.symbolsUrl=[],this.currentIndex=0,this.sucessIndex=0,this.allCalls=[],this.loadedSymbols=!1,this.symbolsRootUrl="assets/",this.selectedSymbolUrl="",this.categories=data.categories,msg.on("on-esc-key-click",this.close,this),msg.on("open-symbols",this.close,this),msg.on("open-shapes",this.open,this),msg.on("load-shapes",this.load,this),this.htmlString=svgImg.stringToHtml(),$(document).mouseup(function(e){o.is(e.target)||t.show(),t.is(e.target)||0!==t.has(e.target).length||o.is(e.target)||($(".leftpane .list-group-item.add-geometry").removeClass("active-left-side-tool"),t.hide())})}var t,o
return e.prototype.load=function(){var e=this
if(!e.loadedSymbols)return new Promise(function(t,o){e.$http.get("https://assets.onlinelogomaker.com/list_shapes.json?v="+Math.floor(Date.now()/1e3)).then(function(o){e.$scope.$.categories=o.data,e.symbolsUrl=o.data[0],e.loadedSymbols=!0,t(e.loadedSymbols)})})},e.prototype.onEscKeyClick=function(){$(".leftpane .list-group-item.add-geometry").removeClass("active-left-side-tool"),this.close()},e.prototype.open=function(){$(".leftpane .list-group-item.add-geometry").addClass("active-left-side-tool"),this.loadedSymbols?t.show():(glassLoader.start(),this.load().then(function(){t.show(),glassLoader.stop()}))},e.prototype.close=function(){this.abortCalls(),$(".leftpane .list-group-item.add-geometry").removeClass("active-left-side-tool"),t.hide()},e.prototype.getShapes=function(){return this.symbolsUrl},e.prototype.onShapeClick=function(e,t){if($(".selected").removeClass("selected"),t.currentTarget.children.length>0)for(var o in t.currentTarget.children)t.currentTarget.children[o].className+=" selected"
this.selectedSymbol=e,this.onOkClick(),this.close()},e.prototype.getShapeData=function(){var e=this,t=e.currentIndex
if(!(t>=this.getShapes().length)){var o="https://assets.onlinelogomaker.com/svg/geometric-forms/"+e.symbolsUrl[t]
e.currentIndex++,$.ajax({url:o,beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){var n=(new XMLSerializer).serializeToString(t),a=encodeURIComponent(n),s="data:image/svg+xml;charset=utf8,"+a
$("#currimggeo"+e.sucessIndex.toString()).attr("src",s),$("#currimggeo"+e.sucessIndex.toString()).attr("meta",o),e.sucessIndex++},error:function(e,t){}})}},e.prototype.abortCalls=function(){$.each(_this.allCalls,function(e,t){t.abort()})},e.prototype.onCancelClick=function(){msg.send("close-popups")},e.prototype.onSeeMoreSymbolsClick=function(){msg.send("close-popups"),this.abortCalls(),msg.send("open-symbols"),ga("send","event","App Click","See more symbols click","Click")},e.prototype.onOkClick=function(){var e=$("#currimggeo"+this.selectedSymbol).attr("meta")
ga("send","event","App Click","Shape Select",e.toString()),this.abortCalls(),msg.send("add-symbol",e),msg.send("close-popups")},e}(),CardsController=function(){function CardsController(e,t){container=$(".object.add-cards"),activator=$(".leftpane .list-group-item.add-cards "),container2=$("#buy-premium-modal"),this.$scope=e,this.$scope.$=this,this.$http=t,this.cardsUrl=[],this.allCalls=[],this.cardsLoadedData=[],this.cardsSvgData=[],this.loadedCards=!1,this.selectedCard=0,this.currentIndex=0,this.sucessIndex=0,msg.on("open-cards",this.open,this),$(document).mouseup(function(e){activator.is(e.target)&&container.show(),container.is(e.target)||0!==container.has(e.target).length||container2.is(e.target)||0!==container2.has(e.target).length||activator.is(e.target)||($(".leftpane .list-group-item.add-cards ").removeClass("active-left-side-tool"),container.hide())})}var container,activator
return CardsController.prototype.open=function(){for(var e=this,t=!1,o=$canvas.children,n=o.length-1;n>=0;n--)void 0!==o[n]&&o[n].isCard&&(t=!0)
$(".leftpane .list-group-item.add-cards ").addClass("active-left-side-tool"),this.loadedCards?t?container.show():(glassLoader.start(),e.currentIndex=0,e.sucessIndex=0,container.show()):(glassLoader.start(),this.load().then(function(){container.show()}))},CardsController.prototype.getCardsData=function(){var e=this,t=e.currentIndex
if(!(t>=this.getCards().length)){var o="https://assets.onlinelogomaker.com/cards/"+e.cardsUrl[t],n=e.cardsUrl[t]
e.currentIndex++,$.ajax({url:o,beforeSend:function(t,o){e.allCalls.push(t)},success:function(t){var a=(new XMLSerializer).serializeToString(t),s=encodeURIComponent(a),i="data:image/svg+xml;charset=utf8,"+s,r=document.createElement("canvas"),l=new C2S(500,500),c=new Image
c.width="500",c.height="500",c.src=i
var d=!1,p=window.navigator.userAgent,h=p.indexOf("MSIE "),g=p.indexOf("Trident/");(h>-1||g>-1)&&(d=!0),c.onload=function(){$canvas.getObjects().length>0&&!d?e.getProportionalCanvas(void 0,!1,0,0).then(function(){var t=window.copy2ctx.canvas,a=function(){e.cardsSvgData.push(c),l.drawImage(c,0,0),l.drawImage(r,e.cardsLoadedData[n].x,e.cardsLoadedData[n].y),e.cardsLoadedData[n].x1&&e.cardsLoadedData[n].y1&&l.drawImage(r,e.cardsLoadedData[n].x1,e.cardsLoadedData[n].y1)
var t=l.getSerializedSvg(),a=encodeURIComponent(t),s="data:image/svg+xml;charset=utf8,"+a
$("#currimgcard"+e.sucessIndex.toString()).attr("src",s),$("#currimgcard"+e.sucessIndex.toString()).attr("meta",o),glassLoader.stop(),e.sucessIndex++}
r.width=150,r.height=t.height*(150/t.width),canvasResize(t,r,a)}):($("#currimgcard"+e.sucessIndex.toString()).attr("src",c.src),$("#currimgcard"+e.sucessIndex.toString()).attr("meta",o),glassLoader.stop(),e.sucessIndex++)}},error:function(e,t){}})}},CardsController.prototype.getProportionalCanvas=function(e,t,o,n){var a=this,s=document.createElement("canvas").getContext("2d"),i=document.createElement("canvas"),r=i.getContext("2d"),l=0,c=0
window.cancelRequestAnimFrame(window.renderAnimationFrame),n&&(l=o),o&&(c=n)
var d=document.getElementById("grid"),p=d.backgroundColor
return p&&(d.backgroundColor="",i.backgroundColor=""),t&&!p&&(p="#fff"),canvas.deactivateAllWithDispatch().renderAll(),new Promise(function(e,o){setTimeout(function(){var o=a.getRectBounds(),n=o.bottom-o.top,i=o.right-o.left,d=canvas.getContext()
t&&(d.globalCompositeOperation="destination-over",d.fillStyle=p,d.fillRect(0,0,canvas.width,canvas.height)),p&&a.setBackgroundColor(p,p),trimmed=d.getImageData(o.left,o.top,i,n),s.canvas.width=i,s.canvas.height=n,s.putImageData(trimmed,0,0)
var h=i+l,g=n+c
r.canvas.width=h,r.canvas.height=g,t&&(r.globalCompositeOperation="destination-over",r.fillStyle=p,r.fillRect(0,0,canvas.width,canvas.height)),r.putImageData(s.getImageData(0,0,i,n),l/2,c/2),window.copy2ctx=r,d.globalCompositeOperation="source-over",canvas.renderAll(),e(1)},10)})},CardsController.prototype.toggleGrid=function(e){gridCanvas=document.getElementById("grid_1"),context=gridCanvas.getContext("2d")
var t=gridCanvas.width=window.innerWidth,o=gridCanvas.height=window.innerHeight
if(x=0,y=0,w=t,h=o,this.minorDotSize=1.5,context.beginPath(),context.rect(x,y,w,h),context.clip(),minorRes=20,context.strokeStyle=e,context.fillStyle=e,minorRes){context.beginPath()
for(var n=x;n<=x+w;n+=minorRes)for(var a=y;a<=y+h;a+=minorRes)context.rect(n-.2*this.minorDotSize,a-.2*this.minorDotSize,this.minorDotSize,this.minorDotSize)
context.fill()}},CardsController.prototype.onGridClick=function(enabled,disable){var _this,toggle=document.getElementById("gridToggle"),text="GRID",gridColor="#3D3D3D",canvasColor=document.getElementById("grid").backgroundColor
toggle.className="grid btn btn-default gridOnOff",enabled=eval(enabled),enabled&&(toggle.value=!eval(toggle.value)),disable&&(toggle.value=!1),eval(toggle.value)?(window.gridEnabled=!0,toggle.className+=" active",gridColor=invertColor(canvasColor)):(window.gridEnabled=!1,gridColor=canvasColor||"#fff"),this.toggleGrid(gridColor)},CardsController.prototype.setBackgroundColor=function(e,t){var o=document.getElementById("grid")
o.backgroundColor=t,ctx=o.getContext("2d"),ctx.fillStyle=t,ctx.fillRect(0,0,canvas.width,canvas.height),this.onGridClick(!1),canvas.forEachObject(function(e){e.borderColor=invertColor(t),e.cornerColor=invertColor(t)})},CardsController.prototype.getRectBounds=function(e,t,o,n){for(var a,s,i=canvas.getWidth(),r=canvas.getHeight(),l=canvas.getContext().getImageData(0,0,i,r),c=l.data.length,d={top:null,left:null,right:null,bottom:null},p=0;p<c;p+=4)0!==l.data[p+3]&&(a=p/4%i,s=~~(p/4/i),null===d.top&&(d.top=s,e&&(d.top+=e)),null===d.left?(d.left=a,t&&(d.top+=t)):a<d.left&&(d.left=a,t&&(d.top+=t)),null===d.right?(d.right=a,o&&(d.right+=o)):d.right<a&&(d.right=a,o&&(d.right+=o)),null===d.bottom?(d.bottom=s+2,n&&(d.bottom+=o)):d.bottom<s&&(d.bottom=s+2,n&&(d.bottom+=o)))
return d},CardsController.prototype.getCards=function(){return this.cardsUrl},CardsController.prototype.onOkClick=function(){var e=$("#currimgcard"+this.selectedCard).attr("meta"),t=e.substring(e.indexOf("card-"),e.length),o={}
o.fullUrl=e,o.info=this.cardsLoadedData[t],ga("send","event","App Click","Card Select",e.toString()),this.abortCalls(),msg.send("add-card",o),$(".leftpane .list-group-item.add-cards ").removeClass("active-left-side-tool"),msg.send("close-popups")},CardsController.prototype.onCardClick=function(e,t){var o=this
if(ga("send","event","App Click","Card Click","Premium user click"),$(".selected").removeClass("selected"),t.currentTarget.children.length>0)for(var n in t.currentTarget.children)t.currentTarget.children[n].className+=" selected"
o.selectedCard=e,o.onOkClick(),o.close()},CardsController.prototype.close=function(){$(".leftpane .list-group-item.add-cards ").removeClass("active-left-side-tool"),this.abortCalls(),container.hide()},CardsController.prototype.abortCalls=function(){$.each(_this.allCalls,function(e,t){t.abort()})},CardsController.prototype.load=function(){var e=this
if(!e.loadedCards)return new Promise(function(t,o){e.$http.get("https://assets.onlinelogomaker.com/cards/list_cards.json?v="+Math.floor(Date.now()/1e3)).then(function(o){var n=[]
for(var a in o.data)e.cardsLoadedData=o.data,n.push(a)
e.cardsUrl=n,e.loadedCards=!0,t(e.loadedCards)})})},CardsController}(),CanvasController=function(){function CanvasController(e,t,o){var n=this
this.isBGcolor=!0,this.touched=!1,this.PROJECT_PREFIX="project_",this.projectName=null,this.projectDate=new Date,this.$scope=e,this.$cmd=t,this.$compile=o,this.didFirstMove=null,this.DownloadTimeOut=null,this.moveTracker=[],this.rotateTracker=[],this.typingTracker=[],this.allCalls=[],this.afterTyping=null,this.afterMove,this.afterRotate,this.oldColor="fff",this.newColor="fff",this.downloadUrl="",e.$=this,CanvasController.instance=this,canvas=this.canvas=new fabric.Canvas("canvas",{selection:!1}),this.initAligningGuidelines(canvas),$canvas=new CanvasService(canvas),$currencyService=new CurrencyService,canvas.setWidth(window.innerWidth),canvas.setHeight(window.innerHeight),canvas.selection=!0,document.getElementById("grid").backgroundColor="#ffffff",canvas.forEachObject(function(e){var t=document.getElementById("grid").backgroundColor
e.borderColor=invertColor(t),e.cornerColor=invertColor(t)}),window.addEventListener("resize",function(){setTimeout(function(){var e=$(".leftpane").width(),t=$(".topPane").height(),o=canvas.height-t,n=canvas.width-e
$canvas.selectAll(),canvas.getActiveGroup().left=(n+e)/2+canvas.getActiveGroup().width/3,canvas.getActiveGroup().top=(o+t)/2,$canvas.unselectAll()},100)}),$("#colorpicker-holder-bg").ColorPicker({flat:!0,onSubmit:function(e,t,o,a){n.oldColor=n.newColor,n.newColor=t,n.backgroundColor(t),$(".colorpicker_undo")[2].style.display="block"},onChange:function(e,t,o,a){n.backgroundColor(t)},onShow:function(){$("#colorpicker-holder-bg").ColorPickerSetColor("#ffffff")},onBeforeShow:function(){$("#colorpicker-holder-bg").ColorPickerSetColor("#ffffff")}}),$("#colorpicker-holder-bg").hide(),$(".text-picker").keyup(function(){$(this).val("")}),$("#color-box").click(function(e){$("#mlSelectedColorText").off(),$("#mlColors").off(),$(".colorpicker")[2].style.left=e.clientX.toString()+"px",$(".colorpicker")[2].style.top=e.clientY.toString()+"px",$(".colorpicker_undo")[2].style.display="none",n.oldColor=document.getElementById("grid").backgroundColor.substring(1),n.newColor=document.getElementById("grid").backgroundColor.substring(1),$("#colorpicker-holder-bg").ColorPickerSetColor(document.getElementById("grid").backgroundColor.substring(1)),$("#colorpicker-holder-bg").show(),$("#mlSelectedColorText").keyup(function(){n.onColorChange(this.value)}),$("#mlColors").mouseleave(function(){var e=$canvas.getActiveDobj(),t=$canvas.getOriginColorByObj(e.raw,e.id)
Object.keys(t).length&&n.onColorChange(rgb2hex(t.fill))})}),canvas.on("text:changed",this.onTextChanged),canvas.on("mouse:up",this.removeOpacityAll),canvas.on("object:moving",this.onObjectMove),canvas.on("object:modified",this.onObjectModified),canvas.on("object:rotating",this.onObjectRotate),canvas.on("object:selected",this.onObjectSelect),canvas.on("selection:cleared",this.onObjectSelectCleared),canvas.on("selection:created",this.onObjectSelectCreated),msg.on("share-facebook-twitter",this.shareFT,this),msg.on("object-modified",this.onObjectModified),msg.on("remove-opacity-all",this.removeOpacityAll),msg.on("deselect-all",this.deselectAll),msg.on("scale-obj",this.scaleObj),msg.on("move",this.move,this),msg.on("open-download-page",this.openDownloadPage,this),msg.on("add-symbol",this.addSymbol,this),msg.on("add-card",this.addCard,this),msg.on("add-image",this.addImage,this),msg.on("add-text",this.addText,this),msg.on("add-curved-text",this.addCurvedText,this),msg.on("add-guided-information",this.addGuidedController,this),msg.on("text-font",this.textFont,this),msg.on("download-cancelled",this.abortCalls,this),msg.on("remove-object",this.removeObject,this),msg.on("remove-objects",this.removeObjects,this),msg.on("draw-action-buttons",this.darwActionButtons,this),msg.on("clear-action-buttons",this.clearActionButtons,this),msg.on("on-grid-click",this.onGridClick,this),msg.on("set-background-color",this.setBackgroundColor,this),msg.on("download-canvas",this.downloadCanvas,this),msg.on("prepare-canvas-size",this.prepareCanvasSize,this),msg.on("save-project",this.saveProject,this),msg.on("reset-project-name",this.resetProjectName,this),msg.on("touchedCanvas",this.touchedCanvas,this),msg.on("preview-project",this.previewProject,this),msg.on("preview-canvas-fill",this.fillPreviewCanvas,this),msg.on("update-undo-redo-state",this.updateUndoRedoState,this),msg.on("clear-history",this.clearHistory,this),msg.on("submit-undo",this.bgcolorUndo,this),msg.on("delete-object",this.removeObject,this),msg.on("duplicate-object",this.duplicate,this),t.map("background-color",this.onColorSelect,this,4),t.map("add-symbol",this.addSymbol),t.map("duplicate",this.duplicate,this,3),t.map("move",this.move,this,1),t.map("moved",this.moved,this,0),t.map("rotate",this.rotate,this,1),t.map("scale",this.scale,this,0),t.map("text-color",this.textColor,this,0),t.map("text-changed",this.textChanged,this,0),t.map("text-text-decoration",this.textDecoration,this,4),t.map("text-text-stroke",this.textStroke,this,4),t.map("text-text-align",this.textAlign,this,4),t.map("text-font-text-line-height",this.textLineHeight,this,4),t.map("text-background-color",this.textBackgroundColor,this,4),t.map("text-font",this.textFont,this,4),t.map("text-font-style",this.textFontStyle,this,4),t.map("text-font-weight",this.textFontWeight,this,4),e.undoActive=!1,e.redoActive=!1,keys.bindCtrl(90,this.onUndoClick,this),keys.bindCtrl(89,this.onRedoClick,this),window.gridEnabled=!1,canvas.on("object:moving",function(e){window.gridEnabled&&e.target.set({left:20*Math.round(e.target.left/20),top:20*Math.round(e.target.top/20)})})}return CanvasController.prototype.openHomePage=function(){open(window.homeUrl,"_blank")},CanvasController.prototype.updateUndoRedoState=function(e,t){var o=this
this.$scope.undoActive=e,this.$scope.redoActive=t,setTimeout(function(){o.$scope.$apply()},50),canvas.renderAll()},CanvasController.prototype.initAligningGuidelines=function(e){function t(e){a(e.x+.5,e.y1>e.y2?e.y2+5e4:e.y1-5e4,e.x+.5,e.y2>e.y1?e.y2+5e4:e.y1-5e4)}function o(e){a(e.x1>e.x2?e.x2+5e4:e.x1-5e4,e.y+.5,e.x2>e.x1?e.x2+5e4:e.x1-5e4,e.y+.5)}function n(e,t){var o=document.getElementById("grid").backgroundColor
r.beginPath(),r.lineWidth=c,r.strokeStyle=d,r.strokeStyle=invertColor(o),r.moveTo(e-5,t-5),r.lineTo(e+5,t+5),r.moveTo(e+5,t-5),r.lineTo(e-5,t+5),r.stroke(),r.restore()}function a(e,t,o,n){var a=document.getElementById("grid").backgroundColor
r.save(),r.lineWidth=c,r.strokeStyle=invertColor(a),r.beginPath(),r.moveTo((e+i[4])*p,(t+i[5])*p),r.lineTo((o+i[4])*p,(n+i[5])*p),r.stroke(),r.restore(),r.beginPath(),r.rect((e+i[4])*p-5,(t+i[5])*p-5,10,10),r.fill(),r.restore(),r.beginPath(),r.rect((o+i[4])*p-5,(n+i[5])*p-5,10,10),r.fill(),r.restore()}function s(e,t){e=Math.round(e),t=Math.round(t)
for(var o=e-l,n=e+l;o<=n;o++)if(o===t)return!0
return!1}var i,r=e.getSelectionContext(),l=2,c=3,d="rgb(0, 183, 235)",p=1,h=[],g=[],m=[]
e.on("mouse:down",function(){i=e.viewportTransform,p=e.getZoom()}),e.on("object:moving",function(t){h=[],g=[],m=[]
var o=t.target,n=e.getObjects(),a=o.getCenterPoint(),r=a.x,l=a.y,c=o.getBoundingRectHeight()/i[3],d=o.getBoundingRectWidth()/i[0],p=!1,u=!1
if(e._currentTransform){for(var v=n.length;v--;)if(m[v]=n[v].getCenterPoint(),n[v]!==o){var f=n[v].getCenterPoint(),w=f.x,$=f.y,y=n[v].getBoundingRectHeight()/i[3],b=n[v].getBoundingRectWidth()/i[0]
s(w,r)&&(u=!0,o.setPositionByOrigin(new fabric.Point(w,l),"center","center"),h.push({x:w,y1:$<l?$-y/2-0:$+y/2+0,y2:l>$?l+c/2+0:l-c/2-0})),s(w-b/2,r-d/2)&&(u=!0,o.setPositionByOrigin(new fabric.Point(w-b/2+d/2,l),"center","center"),h.push({x:w-b/2,y1:$<l?$-y/2-0:$+y/2+0,y2:l>$?l+c/2+0:l-c/2-0})),s(w+b/2,r+d/2)&&(u=!0,o.setPositionByOrigin(new fabric.Point(w+b/2-d/2,l),"center","center"),h.push({x:w+b/2,y1:$<l?$-y/2-0:$+y/2+0,y2:l>$?l+c/2+0:l-c/2-0})),s($,l)&&(p=!0,o.setPositionByOrigin(new fabric.Point(r,$),"center","center"),g.push({y:$,x1:w<r?w-b/2-0:w+b/2+0,x2:r>w?r+d/2+0:r-d/2-0})),s($-y/2,l-c/2)&&(p=!0,o.setPositionByOrigin(new fabric.Point(r,$-y/2+c/2),"center","center"),g.push({y:$-y/2,x1:w<r?w-b/2-0:w+b/2+0,x2:r>w?r+d/2+0:r-d/2-0})),s($+y/2,l+c/2)&&(p=!0,o.setPositionByOrigin(new fabric.Point(r,$+y/2-c/2),"center","center"),g.push({y:$+y/2,x1:w<r?w-b/2-0:w+b/2+0,x2:r>w?r+d/2+0:r-d/2-0}))}p||(g.length=0),u||(h.length=0)}}),e.on("before:render",function(){e.clearContext(e.contextTop)}),e.on("after:render",function(){for(var e=h.length;e--;)t(h[e])
for(var e=g.length;e--;)o(g[e])
for(var e=m.length;e--;)n(m[e].x,m[e].y)}),e.on("mouse:up",function(){h.length=g.length=m.length=0,e.renderAll()})},CanvasController.prototype.bgcolorUndo=function(e){var t=this
t.newColor=t.oldColor,t.backgroundColor(t.newColor),$(".colorpicker_undo")[2].style.display="none",$("#colorpicker-holder-bg").ColorPickerSetColor(t.newColor)},CanvasController.prototype.shareFT=function(e){glassLoader.start()
var t=450,o=250,n=0,a=0,s=canvas.width,i=canvas.height,r=0,l=0,c=0
$canvas.selectAll(),n=$canvas.getActiveGroup().width,a=$canvas.getActiveGroup().height,l=$canvas.getActiveGroup().top,c=$canvas.getActiveGroup().left,t-=30,o-=30,r=t/n<o/a?t/n:o/a,t+=30,o+=30,canvas.setWidth(t),canvas.setHeight(o),$canvas.getActiveGroup().set({scaleX:r,scaleY:r,left:canvas.width/2,top:canvas.height/2,originX:"center",originY:"center"})
var d=document.getElementById("grid")
canvas.backgroundColor=d.backgroundColor,canvas.deactivateAllWithDispatch().renderAll()
var p=canvas.toDataURL("png")
p=p.replace("data:image/png;base64,","")
var h,g
switch(function(e){$.ajax({method:"POST",url:"http://advanced1879.inmotionhosting.com:3000/",data:JSON.stringify({img:e,type:"save"}),async:!1}).done(function(e){h=e.img,g=e.page}).fail(function(){console.log("Image wasn't saved")})}(p),$canvas.selectAll(),canvas.setWidth(s),canvas.setHeight(i),r=1/r,$canvas.getActiveGroup().set({scaleX:r,scaleY:r,left:c,top:l,originX:0,originY:0}),canvas.deactivateAllWithDispatch().renderAll(),e){case 1:!function(e){FB.ui({method:"share",name:"Facebook Dialogs",href:"https://onlinelogomaker.com/",link:"https://developers.facebook.com/docs/dialogs/",picture:e,caption:"ONLINE LOGO MAKER",description:"Image created by Online Logo Maker"},function(e){})}(h)
break
case 2:!function(){var e
e="width=500,height=300,top="+($(window).height()/2-150)+",left="+($(window).width()/2-250),window.open("https://twitter.com/intent/tweet?text=Online%20Logo%20Maker%20-%20Create%20Your%20Logo&url="+g+"&via=logogenerator","_blank",e,!1)}()}canvas.backgroundColor="",glassLoader.stop()},CanvasController.prototype.clearHistory=function(){this.$scope.undoActive=!1,this.$scope.redoActive=!1},CanvasController.prototype.duplicate=function(){var e=$.extend(!0,{},$canvas.getActiveDobj()),t=$.extend(!0,{},e.raw),o=e.type,n=t,a=!0
switch(t.type){case"i-text":case"text":n=t.clone(),a=!0
break
case"group":case"path-group":o=DOType.SYMBOL
for(var s=0;s<n.paths.length;s++)n.paths[s]=$.extend(!0,{},n.paths[s])
break
case"image":n=fabric.util.object.clone(t),a=!0
break
default:n=fabric.util.object.clone(t),a=!1}$cmd.run("add",$canvas.create(o,n,a,$canvas.getActiveDobj().shadow),a,35,15),msg.send("draw-action-buttons",n),$cmd.history[$cmd.history.length-1].args[2]=0,$cmd.history[$cmd.history.length-1].args[3]=0},CanvasController.prototype.rotate=function(e,t){e.raw.rotate(e.raw.getAngle()+t),canvas.renderAll()},CanvasController.prototype.move=function(e,t,o){msg.send("object-modified",e),e.raw.setLeft(e.raw.left+t),e.raw.setTop(e.raw.top+o),e.raw.setCoords(),canvas.renderAll()},CanvasController.prototype.moved=function(e,t,o){var n=CanvasController.instance
e.raw.set({left:o.left,top:o.top}).setCoords(),n.darwActionButtons(e.raw),canvas.renderAll()},CanvasController.prototype.scale=function(e,t,o,n,a){e.raw?e.raw.set({scaleX:o.x,scaleY:o.y,top:o.t,left:o.l}):e.set({scaleX:o.x,scaleY:o.y,top:o.t,left:o.l}),msg.send("update-scale"),canvas.renderAll()},CanvasController.prototype.scaleObj=function(e,t,o){e.set({scaleX:t,scaleY:o,originX:"center",originY:"center"}),msg.send("update-scale-obj")},CanvasController.prototype.textChanged=function(e,t,o){e.raw.setText(o),canvas.renderAll()},CanvasController.prototype.textColor=function(e,t,o){var n=CanvasController.instance;-1==o.indexOf("#")&&(o="#"+o),$canvas.setFillColor(e.raw,e.id,o),e.raw.fill=o,n.darwActionButtons(e.raw)},CanvasController.prototype.textFont=function(e,t){this.selected.fontFamily=t,canvas.renderAll(),msg.send("update-text-font")},CanvasController.prototype.textFontStyle=function(e,t){this.selected.fontStyle=t,msg.send("update-text-btn-style",t),canvas.renderAll()},CanvasController.prototype.textFontWeight=function(e,t){this.selected.fontWeight=t,msg.send("update-text-btn-weight",t),canvas.renderAll()},CanvasController.prototype.textDecoration=function(e,t){this.selected.textDecoration=t,canvas.renderAll()},CanvasController.prototype.textStroke=function(e,t){this.selected.stroke=t,canvas.renderAll()},CanvasController.prototype.textAlign=function(e,t){this.selected.textAlign=t,canvas.renderAll()},CanvasController.prototype.textLineHeight=function(e,t){this.selected.lineHeight=t,canvas.renderAll()},CanvasController.prototype.textBackgroundColor=function(e,t){this.selected.textBackgroundColor=t,canvas.renderAll()},CanvasController.prototype.addCurvedText=function(e,t,o,n,a,s){new fabric.CurvedText("CurvedText",{left:t,top:o,textAlign:"center",fill:"#0000FF",effect:"STRAIGHT",radius:150,fontSize:20,spacing:20})
$cmd.run("add",$canvas.create(DOType.CURVEDTEXT,e),!1,t,o),canvas.renderAll(),canvas.setActiveObject(canvas.item(canvas.getObjects().length-1))},CanvasController.prototype.addSymbol=function(e,t,o){var n=this
fabric.loadSVGFromURL(e,function(e,a){e.options=a
var s=fabric.util.groupSVGElements(e,a)
$cmd.run("add",$canvas.create(DOType.SYMBOL,s),!1,t,o),n.touched=!0,canvas.renderAll(),canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),$(".object-option .text-container").hide(),$("#id-zindex-buttonbar").show()),msg.send("update-items"),canvas.renderAll()})},CanvasController.prototype.addGuidedController=function(e,t,o,n,a,s,i){var r=this
$canvas.removeAll(),fabric.loadSVGFromString(e,function(e,s){e.options=s
var l=fabric.util.groupSVGElements(e,s)
r.addText(n,t,o,void 0,void 0,!0,a,i)
var c=$canvas.getActiveDobj().raw
$canvas.getActiveDobj().raw.height,$canvas.getActiveDobj().raw.scaleY,$cmd.run("add",$canvas.create(DOType.SYMBOL,l),!1,t,o)
var d=$canvas.getActiveDobj().raw.width*$canvas.getActiveDobj().raw.scaleX/2
$canvas.getActiveDobj().raw.left=t+c.width*c.scaleX/2-d,$canvas.getActiveDobj().raw.top=o-$canvas.getActiveDobj().raw.height*$canvas.getActiveDobj().raw.scaleY,$canvas.getActiveGroup().setCoords(),$canvas.selectAll(),$canvas.getActiveGroup().set({scaleX:2,scaleY:2,originX:"center",originY:"center"}),$canvas.unselectAll()}),$canvas.unselectAll(),$cmd.run("background-color",$oCanvasColor.previous,s)},CanvasController.prototype.addCard=function(e){for(var t=this,o=!1,n=$(".leftpane").width(),a=$(".topPane").height(),s=(canvas.height,canvas.width-2*n),i=(s+n)/2,r=a,l=$canvas.children,c=l.length-1;c>=0;c--)void 0!==l[c]&&l[c].isCard&&(o=!0,$canvas.remove(l[c]))
$canvas.unselectAll(),$canvas.selectAll()
var d=$canvas.getActiveGroup()
$canvas.getActiveGroup()&&(o?$canvas.getActiveGroup().set({left:i+parseInt(e.info.logoOffSetX),top:r+parseInt(e.info.logoOffSetY)}):$canvas.getActiveGroup().set({scaleX:.4,scaleY:.4,originX:"center",originY:"center",left:i+parseInt(e.info.logoOffSetX),top:r+parseInt(e.info.logoOffSetY)})),$canvas.getActiveGroup().setCoords(),$canvas.unselectAll(),$canvas.selectAll(),fabric.loadSVGFromURL(e.fullUrl,function(o,n){o.options=n
var a=fabric.util.groupSVGElements(o,n)
a.isCard=!0,$cmd.run("add",$canvas.create(DOType.SYMBOL,a),!1,i,r,500,500)
var s=parseInt(e.info.textX),l=parseInt(e.info.textY)
if(s&&l&&s+i<window.innerWidth&&l+r<window.innerHeight){var c=i+parseInt(e.info.textX),p=r+parseInt(e.info.textY)
t.addText(Tools.translateText("Enter-a-text-text"),c,p,parseInt(e.info.textW),parseInt(e.info.textH)/2,!1,"MyriadPro","#000")}if(s=parseInt(e.info.text1X),l=parseInt(e.info.text1Y),s&&l&&s+i<window.innerWidth&&l+r<window.innerHeight){var c=i+parseInt(e.info.text1X),p=r+parseInt(e.info.text1Y)
t.addText(Tools.translateText("Enter-a-text-text"),c,p,parseInt(e.info.text1W),parseInt(e.info.text1H)/2,!1,"MyriadPro","#000")}if(s=parseInt(e.info.text2X),l=parseInt(e.info.text2Y),s&&l&&s+i<window.innerWidth&&l+r<window.innerHeight){var c=i+parseInt(e.info.text2X),p=r+parseInt(e.info.text2Y)
t.addText(Tools.translateText("Enter-a-text-text"),c,p,parseInt(e.info.text2W),parseInt(e.info.text2H)/2,!1,"MyriadPro","#000")}if(s=parseInt(e.info.text3X),l=parseInt(e.info.text3Y),s&&l&&s+i<window.innerWidth&&l+r<window.innerHeight){var c=i+parseInt(e.info.text3X),p=r+parseInt(e.info.text3Y)
t.addText(Tools.translateText("Enter-a-text-text"),c,p,parseInt(e.info.text3W),parseInt(e.info.text3H)/2,!1,"MyriadPro","#000")}t.touched=!0,canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),$(".object-option .text-container").hide(),$("#id-zindex-buttonbar").show())
for(var h=0;h<d._objects.length;h++)for(var g=0;g<20;g++)d._objects[h].bringForward()
$canvas.unselectAll(),msg.send("update-items"),msg.send("disable-preview"),canvas.renderAll()}),canvas.renderAll()},CanvasController.prototype.addImage=function(e){var t=this
fabric.Image.fromURL(e,function(e){var o=window.innerWidth/2-e.width/2,n=window.innerHeight/2-e.height/2
$cmd.run("add",$canvas.create(DOType.IMAGE,e),!1,o,n),t.touched=!0,canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),$(".object-option .text-container").hide(),$("#id-zindex-buttonbar").show())}),msg.send("update-items"),canvas.renderAll()},CanvasController.prototype.addText=function(e,t,o,n,a,s,i,r){var l=0,c=0
if($canvas.children.length>0){var d=$canvas.children[0].raw
l=15,c=30,l+=d.left,c+=d.top}var p="Adamcg-Pro",h="#000000"
if(i&&(p=i),r&&(h=r),e.isCard)var g=new fabric.IText(e,{left:l,top:c,padding:0,fontFamily:p,isCard:!0,fill:h})
else var g=new fabric.IText(e,{left:l,top:c,padding:0,fontFamily:p,fill:h})
$cmd.run("add",$canvas.create(DOType.ITEXT,g),!1,t,o,n,a),s||($canvas.getActiveObj().enterEditing(),$canvas.getActiveObj().set("showplaceholder",!0),$canvas.getActiveObj().hiddenTextarea.focus()),this.touched=!0,!($canvas.children.length>0)||n&&a||$canvas.getLastObj().top+$canvas.getLastObj().height+80>canvas.height&&($canvas.getLastObj().top=50,$canvas.getLastObj().setCoords(),canvas.renderAll()),msg.send("update-items")},CanvasController.prototype.addListeners=function(e){e.on("selected",this.onObjectMove),e.on("moving",this.onObjectMove)},CanvasController.prototype.onObjectSelect=function(e){var t=CanvasController.instance,o=$canvas.getActiveDobj()
CanvasController.instance.selected=e.target,void 0!==o&&null!==o&&void 0!==e.e&&null!==e.e&&Object.keys(o).length&&(t.moveTracker.push({dobj:o,top:o.raw.top,left:o.raw.left}),null!==o.raw.text&&void 0!==o.raw.text&&t.typingTracker.push(o.raw.text),t.rotateTracker.push({angle:$canvas.getActiveDobj().raw.angle}),canvas.object=e.target,t.darwActionButtons(e.target))},CanvasController.prototype.onObjectSelectCreated=function(e){this.onObjectSelect(e)},CanvasController.prototype.onObjectSelectCleared=function(e){CanvasController.instance.removeActionButtons(),msg.send("deselect-all")},CanvasController.prototype.onTextChanged=function(e){var t=CanvasController.instance,o=$canvas.getActiveDobj(),n=o.raw.text
0!==t.typingTracker.length&&(clearTimeout(this.afterTyping),delete this.afterTyping,this.afterTyping=setTimeout(function(){t.typingTracker.push(o.raw.text)
var e=t.typingTracker.length
$cmd.store("text-changed",o,t.typingTracker[e-2],n)},200))},CanvasController.prototype.onKeyboardPressed=function(e){},CanvasController.prototype.onObjectMove=function(e){if(null!==canvas.getActiveObject()&&void 0!==canvas.getActiveObject()){msg.send("transformed",e)
var t=CanvasController.instance,o=$.extend(!0,{},$canvas.getActiveDobj()),n={},a={}
t.moveTracker.push({dobj:o,top:o.raw.top,left:o.raw.left}),clearTimeout(this.afterMove),delete this.afterMove,this.afterMove=setTimeout(function(){var e=$canvas.getActiveDobj()
n={top:t.moveTracker[0].top,left:t.moveTracker[0].left},a={top:e.raw.top,left:e.raw.left},$cmd.run("moved",e,n,a),t.moveTracker=[]},100),t.removeActionButtons()}},CanvasController.prototype.onObjectModified=function(e){var t=CanvasController.instance
e=e.target?e.target:e.raw,t.darwActionButtons(e)},CanvasController.prototype.onObjectRotate=function(e){var t=CanvasController.instance,o=$.extend(!0,{},$canvas.getActiveDobj())
t.rotateTracker.push({angle:o.raw.angle}),clearTimeout(this.afterRotate),delete this.afterRotate,this.afterRotate=setTimeout(function(){var e=$canvas.getActiveDobj(),o=e.raw.angle-t.rotateTracker[0].angle
$cmd.store("rotate",e,o),t.rotateTracker=[]},100)},CanvasController.prototype.onRedoClick=function(){this.$cmd.redo()},CanvasController.prototype.onUndoClick=function(){this.$cmd.undo()},CanvasController.prototype.backgroundColor=function(e){$oCanvasColor.previous=$oCanvasColor.current,$oCanvasColor.current=e,$cmd.run("background-color",$oCanvasColor.previous,e)},CanvasController.prototype.onColorSelect=function(e,t){var o="#"+t
document.getElementById("grid")
$(".background-picker div").css("background-color",o),this.setBackgroundColor(e,o)},CanvasController.prototype.onColorChange=function(e,t){var o="#"+t
$(".background-picker div").css("background-color",o),this.setBackgroundColor(e,o)},CanvasController.prototype.setBackgroundColor=function(e,t){var o=document.getElementById("grid")
o.backgroundColor=t,ctx=o.getContext("2d"),ctx.fillStyle=t,ctx.fillRect(0,0,canvas.width,canvas.height),this.onGridClick(!1),canvas.forEachObject(function(e){e.borderColor=invertColor(t),e.cornerColor=invertColor(t)})},CanvasController.prototype.onGridClick=function(enabled,disable){var _this,toggle=document.getElementById("gridToggle"),text="GRID",gridColor="#3D3D3D",canvasColor=document.getElementById("grid").backgroundColor
toggle.className="grid btn btn-default gridOnOff",enabled=eval(enabled),enabled&&(toggle.value=!eval(toggle.value)),disable&&(toggle.value=!1),eval(toggle.value)?(window.gridEnabled=!0,toggle.className+=" active",gridColor=invertColor(canvasColor)):(window.gridEnabled=!1,gridColor=canvasColor||"#fff"),this.toggleGrid(gridColor)},CanvasController.prototype.toggleGrid=function(e){gridCanvas=document.getElementById("grid_1"),context=gridCanvas.getContext("2d")
var t=gridCanvas.width=window.innerWidth,o=gridCanvas.height=window.innerHeight
if(x=0,y=0,w=t,h=o,this.minorDotSize=1.5,context.beginPath(),context.rect(x,y,w,h),context.clip(),minorRes=20,context.strokeStyle=e,context.fillStyle=e,minorRes){context.beginPath()
for(var n=x;n<=x+w;n+=minorRes)for(var a=y;a<=y+h;a+=minorRes)context.rect(n-.2*this.minorDotSize,a-.2*this.minorDotSize,this.minorDotSize,this.minorDotSize)
context.fill()}},CanvasController.prototype.clearActionButtons=function(){$(".actionButtons").remove()},CanvasController.prototype.darwActionButtons=function(e){var t=CanvasController.instance
_
var o=$(".actionButtons")
if(null!==canvas.getActiveObject()&&void 0!==canvas.getActiveObject()){this.clearActionButtons()
var n,a,s,i,r,l,c,d,p,h,g,m,u,v,f,w
setTimeout(function(){o.remove(),t.clearActionButtons(),n=e.width/2,a=e.height/2,s=e.scaleX,i=e.scaleY,void 0!==e.oCoords&&null!==e.oCoords?(r=e.oCoords.tr.x,l=e.oCoords.tr.y,c=e.oCoords.bl.x,d=e.oCoords.bl.y,p=c+r,h=d+l):(p=e.left,h=e.top),midX=(e.oCoords.br.x+e.oCoords.tl.x)/2,midY=(e.oCoords.mr.y+e.oCoords.ml.y)/2,n*=s,g=midX+e.getBoundingRect().width/2,m=midY,g+=40,u=m+-40,f=m,w=m- -40,v=m- -80
var y,b,C,x,k
b='<button onclick="msg.send(\'duplicate-object\')" class="btn btn-default actionButtons dupBtn"style="position:absolute;top:'+u+"px;left:"+g+'px; z-index: 3;">'+Tools.translateText("duplicate-text")+"</button>",C='<button onclick="msg.send(\'delete-object\')" class="btn btn-default actionButtons delBtn"style="position:absolute;top:'+v+"px;left:"+g+'px; z-index: 3;">'+Tools.translateText("delete-text")+"</button>",x='<button onclick="msg.send (\'object-bringforward\');" id="bring-forward-btn" class="btn btn-default actionButtons bringforwardBtn" style="position:absolute;top:'+f+"px;left:"+g+'px; z-index: 3;">'+Tools.translateText("id-bringforward-btn")+"</button>",k='<button onclick="msg.send (\'object-sendbackwards\');" id="send-backwards-btn" class="btn btn-default actionButtons sendbackwardsBtn"style="position:absolute;top:'+w+"px;left:"+g+'px; z-index: 3;">'+Tools.translateText("id-sendbackwards-btn")+"</button>",y=b+x+k+C,$(".canvas").append(t.$compile(y)(t.$scope))
var S=canvas.getActiveObject(),T=canvas.getObjects().indexOf(S),j=0===T,O=T==canvas.getObjects().length-1
$("#bring-forward-btn").prop("disabled",O),$("#send-backwards-btn").prop("disabled",j)},150)}},CanvasController.prototype.removeActionButtons=function(){$(".actionButtons").remove()},CanvasController.prototype.setZoom=function(e){var t=canvas.getObjects()
for(var o in t){var n=t[o].scaleX,a=t[o].scaleY,s=t[o].left,i=t[o].top,r=n*e,l=a*e,c=s*e,d=i*e
t[o].scaleX=r,t[o].scaleY=l,t[o].left=c,t[o].top=d,canvas.renderAll(),t[o].raw.setCoords()}canvas.renderAll()},CanvasController.prototype.removeObject=function(){var e=0
$canvas.children.forEach(function(e){if(e.selected)if(e.isCard&&"I-TEXT"!=e.type)for(var t=$canvas.children,o=t.length-1;o>=0;o--)void 0!==t[o]&&t[o].isCard&&$canvas.remove(t[o])
else $cmd.run("remove",e)}),$canvas.children.forEach(function(t){t.isCard&&e++}),0==e&&msg.send("enable-preview"),this.touched=!0,canvas.renderAll()},CanvasController.prototype.removeObjects=function(){$cmd.run("remove-all"),canvas.renderAll()},CanvasController.prototype.removeOpacityAll=function(){$canvas.children.forEach(function(e){e.type==DOType.SYMBOL&&e.raw.getObjects().forEach(function(e){e.hasOwnProperty("invisible")?e.invisible||e.setOpacity(1):e.setOpacity(1)})}),canvas.renderAll()},CanvasController.prototype.deselectAll=function(e){$canvas.children.forEach(function(e){e.type==DOType.SYMBOL&&e.raw.getObjects().forEach(function(e){e.hasOwnProperty("invisible")&&(e.invisible?e.setOpacity(0):e.setOpacity(1))}),e.selected=!1})},CanvasController.prototype.getProportionalCanvas=function(e,t,o,n){var a=this,s=document.createElement("canvas").getContext("2d"),i=document.createElement("canvas"),r=i.getContext("2d"),l=0,c=0
window.cancelRequestAnimFrame(window.renderAnimationFrame),n&&(l=o),o&&(c=n)
var d=document.getElementById("grid"),p=d.backgroundColor
return p&&(d.backgroundColor=p,i.backgroundColor=p),t&&!p&&(p="#fff"),this.removeOpacityAll(),canvas.deactivateAllWithDispatch().renderAll(),new Promise(function(e,o){setTimeout(function(){var o=a.getRectBounds(),n=o.bottom-o.top,i=o.right-o.left,d=canvas.getContext()
t&&(d.globalCompositeOperation="destination-over",d.fillStyle=p,d.fillRect(0,0,canvas.width,canvas.height)),trimmed=d.getImageData(o.left,o.top,i,n),s.canvas.width=i,s.canvas.height=n,s.putImageData(trimmed,0,0)
var h=i+l,g=n+c
r.canvas.width=h,r.canvas.height=g,t&&(r.globalCompositeOperation="destination-over",r.fillStyle=p,r.fillRect(0,0,canvas.width,canvas.height)),r.putImageData(s.getImageData(0,0,i,n),l/2,c/2),window.copy2ctx=r,d.globalCompositeOperation="source-over",canvas.renderAll(),e(1)},10)})},CanvasController.prototype.downloadCanvas=function(e,t,o,n,a,s,i,r,l,c){var d=this
!1===l&&(t=this.isBGcolor),msg.send("download-in-progress"),this.getProportionalCanvas(e,t,o,n,a,s,i,r).then(function(){function e(){var e=Base64Binary.decode(m,null),n={name:p,imgRaw:e,width:a,height:s,areacolor:t,ext:".png"}
if(window.downloadFiles.unshift(n),l&&(t||500==a)){var i=Base64Binary.decode(g,null),r={name:p,imgRaw:i,width:a,height:s,areacolor:!0,ext:".jpg"}
window.downloadFiles.unshift(r)}if(c){var u=""
h.file(p+".png",e,{base64:!0})
for(var v=0;v<window.downloadFiles.length;v++)u="",window.downloadFiles[v].areacolor||(u="-transparent"),h.file(p+"-"+window.downloadFiles[v].width+u+window.downloadFiles[v].ext,window.downloadFiles[v].imgRaw,{base64:!0})
var f={},w=new fabric.Canvas("clonee"),y=JSON.stringify(canvas)
w.loadFromJSON(y,function(){for(var e,t,n=["arial"],a=w.getObjects("i-text"),s=w.getObjects("text"),i="https://assets.onlinelogomaker.com/fonts/",r="",c=w.getObjects(),g=Number.MAX_VALUE,m=Number.MAX_VALUE,u=0,v=0,y=0;y<c.length;y++)c[y].top<g&&(g=c[y].top),c[y].left<m&&(m=c[y].left)
g-=10,m-=10
for(var y=0;y<c.length;y++)c[y].top=c[y].top-g,c[y].left=c[y].left-m,e=c[y].left+c[y].width*c[y].scaleX,t=c[y].top+c[y].height*c[y].scaleY,e>u&&(u=e),t>v&&(v=t)
for(w.width=u+=50,w.height=v+=50,f=w.toSVG(),r+="Logo designed using Online Logo Maker\r\nhttps://onlinelogomaker.com\r\n\r\nFonts used in this project:\r\n\r\n",y=0;y<a.length;y++){n.push(a[y].fontFamily),f=f.replace(a[y].fontFamily,"'"+Tools.mapOlmFont(a[y].fontFamily)+"'")
Tools.mapOlmFont(a[y].fontFamily)
r+=i+a[y].fontFamily+".ttf\r\n"}for(y=0;y<s.length;y++){n.push(s[y].fontFamily),f=f.replace(s[y].fontFamily,"'"+Tools.mapOlmFont(s[y].fontFamily)+"'")
Tools.mapOlmFont(s[y].fontFamily)
r+=i+s[y].fontFamily+".ttf\r\n"}var b=Base64Binary.encode(f)
if(l){var C
$.ajax({type:"POST",url:"server/php/GetNewFormat.php",data:{image:b},async:!1}).done(function(e){C=e.image})
var x=Base64Binary.decode(C,null)
h.file(p+".eps",x)}r+="\r\n\r\nInstructions to install fonts on windows: \r\n 1- Find and Download your fonts from the links above \r\n 2- Double click the .ttf file \r\n 3- Click on the install button and allow it to install",h.file("Readme.txt",r),h.file(p+".svg",f),h.generateAsync({type:"blob"}).then(function(e){}),document.cookie="projectName="+d.projectDate.getTime()+"; path=/; domain=.onlinelogomaker.com"
!function(){var e=Tools.QueryString()
e.lang||(e.lang="en"),window.lang&&(e.lang=window.lang)
var t={fileName:p,png:o,lang:e.lang}
window.logged&&parseInt(window.user.premium_status)?h.generateAsync({type:"base64"}).then(function(e){t.zip=e,d.sendPostData(t)}):d.sendPostData(t)}()})}ga("send","event","IfPreviewGenerated","Yes",{nonInteraction:1})}var o,n=window.copy2ctx,i=n.canvas,r=document.createElement("canvas")
r.height=i.height,r.width=i.width,r.getContext("2d").drawImage(i,0,0)
var p=Tools.generateOlmFileName(),h=new JSZip,o=r.toDataURL("png")
o=o.replace("data:image/png;base64,","")
var g=o,m=o,u=document.getElementById("grid").backgroundColor
u||(u="#FFF"),$.ajax({type:"POST",url:"server/php/GetResolution.php",data:{image:o,bgColor:u},async:!1}).done(function(t){m=t.imagepng,g=t.imagejpg,e()})}).catch(function(e){console.log("Handle rejected promise ("+e+") here."),glassLoader.stop(),ga("send","event","IfPreviewGenerated","No",{nonInteraction:1}),alert("Sorry, something went wrong, please try again later or contact support.")})},CanvasController.prototype.fillCards=function(){this.getProportionalCanvas(void 0,!1,0,0).then(function(){var e=window.copy2ctx.canvas,t=document.getElementById("preview-download-canvas").getContext("2d"),o=document.createElement("canvas"),n=Tools.getQueryParameters("p")
if("2"==n||"4"==n){var a=function(){t.clearRect(0,0,canvas.width,canvas.height),t.drawImage(o,71,68),t.drawImage(o,250,83),t.drawImage(o,403,78),t.drawImage(o,558,76)}
o.width=65,o.height=e.height*(65/e.width),canvasResize(e,o,a)}else{var a=function(){t.clearRect(0,0,canvas.width,canvas.height),t.drawImage(o,55,50),t.drawImage(o,188,62),t.drawImage(o,300,61),t.drawImage(o,418,57)}
o.width=45,o.height=e.height*(45/e.width),canvasResize(e,o,a)}})},CanvasController.prototype.fillPreviewCanvas=function(){this.getProportionalCanvas(void 0,!1,0,0).then(function(){var e=window.copy2ctx.canvas,t=document.getElementById("preview-download-canvas").getContext("2d"),o=document.createElement("canvas"),n=(Tools.getQueryParameters("p"),function(){t.clearRect(0,0,canvas.width,canvas.height),t.drawImage(o,71,68),t.drawImage(o,250,83),t.drawImage(o,403,78),t.drawImage(o,558,76)})
o.width=65,o.height=e.height*(65/e.width),canvasResize(e,o,n)})},CanvasController.prototype.sendPostData=function(e){var t=this
$.ajax({type:"POST",url:"https://www.onlinelogomaker.com/version2_scripts/downloadlogo.php",data:e,success:function(e){var o=document.getElementById("dlink"),n=Tools.getQueryParameters("ex")
t.downloadUrl="1"==n?Tools.translateText("olm-become-premium-url"):e,o.innerHTML=Tools.translateText("download-logo-text")
var a=o.parentNode,s=document.createElement("a"),i=e,r=e.indexOf("filename="),l=e.substring(r,e.length)
finalURL="https://www.onlinelogomaker.com/version2_scripts/StoreOlmFileName.php?"+l,$.ajax({type:"GET",url:finalURL}).then(function(e){s.href=i,s.id="wrapperImg",s.target="_blank",s.className="child",a.replaceChild(s,o),s.appendChild(o)}).fail(function(){}),msg.send("save-project",!0,!0),msg.send("zip-complete"),ga("send","event","IfPreviewReceived","Yes",{nonInteraction:1})}}).fail(function(){ga("send","event","IfPreviewReceived","No",{nonInteraction:1})})},CanvasController.prototype.prepareCanvasSize=function(e){this.getProportionalCanvas(void 0,!1,0,0).then(function(){msg.send(e)})},CanvasController.prototype.openDownloadPage=function(){},CanvasController.prototype.previewProject=function(e){this.getProportionalCanvas(void 0,!1,0,0).then(function(){var e=window.copy2ctx.canvas,t=document.getElementById("preview-canvas").getContext("2d"),o=document.createElement("canvas"),n=function(){t.clearRect(0,0,canvas.width,canvas.height),t.drawImage(o,71,68),t.drawImage(o,250,83),t.drawImage(o,403,78),t.drawImage(o,558,76)}
o.width=65,o.height=e.height*(65/e.width),canvasResize(e,o,n)}),ga("send","event","App Click","Preview Project Button","Preview Clicked"),$("#preview-modal").show()},CanvasController.prototype.saveProject=function(e,t,o){var n=this
t||glassLoader.start()
var a=!1
window.skip&&(a=!0)
var s=this.projectDate.getTime(),i=Tools.generateOlmFileName(),r=Tools.getCookie("userguestid")
if(""==r){var l=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",l,260),r=Tools.getCookie("userguestid")}var c="https://www.onlinelogomaker.com/version2_scripts/SaveUserData_haxed.php?"
window.user.id
this.projectName=this.PROJECT_PREFIX+s
var d=r+".olmn",p=r+".dolmn",h=$("#download-email-input-box").val(),g=c+"user_id="+r+"&type=projects&name="+d+"&email="+h.toString(),m=c+"user_id="+r+"&type=projects&name="+p,u=canvas.toJSON([]),v=document.getElementById("grid").backgroundColor
v&&(u.bgColor=v),u=JSON.stringify(u)
var f=JSON.stringify($canvas.children),w=!0;(o||a)&&(w=!1),this.getProportionalCanvas(void 0,w,100,20).then(function(){function e(){var e=l.toDataURL("png")
e=e.replace("data:image/png;base64,","")
var o=Base64Binary.decode(e,null)
$.ajax({type:"POST",url:g.replace(".olmn",".png"),id:s,dataType:"json",data:o,beforeSend:function(e,o){n.allCalls.push(e),t||(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$("#new-modal").hide(),ga("send","event","App Click","Save Project","Saved project"))},headers:{"Content-Type":"text/plain;charset=utf-8"},processData:!1}).then(function(e){t||(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$("#new-modal").hide(),ga("send","event","App Click","Save Project","Saved project")),n.$scope.$apply()}).fail(function(){})}function o(){null==window.downloadFiles&&(window.downloadFiles=[])
var e=Base64Binary.decode(y,null),o={name:i,imgRaw:e,width:2e3,height:2e3,areacolor:w,ext:".png"}
window.downloadFiles.unshift(o)
var n=Base64Binary.decode(v,null),a={name:i,imgRaw:n,width:500,height:500,areacolor:!0,ext:".jpg"}
window.downloadFiles.unshift(a)
var s=""
h.file(i+".png",e,{base64:!0})
for(var r=0;r<window.downloadFiles.length;r++)s="",window.downloadFiles[r].areacolor||(s="-transparent"),h.file(i+"-"+window.downloadFiles[r].width+s+window.downloadFiles[r].ext,window.downloadFiles[r].imgRaw,{base64:!0})
var l={},d=new fabric.Canvas("clonee"),p=JSON.stringify(canvas)
d.loadFromJSON(p,function(){for(var e,o,n=["arial"],a=d.getObjects("i-text"),s=d.getObjects("text"),r="https://assets.onlinelogomaker.com/fonts/",p="",g=d.getObjects(),m=Number.MAX_VALUE,u=Number.MAX_VALUE,v=0,f=0,w=0;w<g.length;w++)g[w].top<m&&(m=g[w].top),g[w].left<u&&(u=g[w].left)
m-=10,u-=10
for(var w=0;w<g.length;w++)g[w].top=g[w].top-m,g[w].left=g[w].left-u,e=g[w].left+g[w].width*g[w].scaleX,o=g[w].top+g[w].height*g[w].scaleY,e>v&&(v=e),o>f&&(f=o)
for(d.width=v+=10,d.height=f+=10,l=d.toSVG(),p+="Logo designed using Online Logo Maker\r\nhttps://onlinelogomaker.com\r\n\r\nFonts used in this project:\r\n\r\n",w=0;w<a.length;w++){n.push(a[w].fontFamily),l=l.replace(a[w].fontFamily,Tools.mapOlmFont(a[w].fontFamily))
Tools.mapOlmFont(a[w].fontFamily)
p+=r+a[w].fontFamily+".ttf\r\n"}for(w=0;w<s.length;w++){n.push(s[w].fontFamily),l=l.replace(s[w].fontFamily,Tools.mapOlmFont(s[w].fontFamily))
Tools.mapOlmFont(s[w].fontFamily)
p+=r+s[w].fontFamily+".ttf\r\n"}var y,b=Base64Binary.encode(l)
$.ajax({type:"POST",url:"server/php/GetNewFormat.php",data:{image:b},async:!1}).done(function(e){y=e.image})
var C=Base64Binary.decode(y,null)
h.file(i+".eps",C),p+="\r\n\r\nInstructions to install fonts on windows: \r\n 1- Find and Download your fonts from the links above \r\n 2- Double click the .ttf file \r\n 3- Click on the install button and allow it to install",h.file("Readme.txt",p),h.file(i+".svg",l),h.generateAsync({type:"blob"}).then(function(e){})
!function(){var e=Tools.QueryString()
e.lang||(e.lang="en"),window.lang&&(e.lang=window.lang)
var o={fileName:i,png:c,lang:e.lang}
h.generateAsync({type:"base64"}).then(function(e){o.zip=e
var n=Tools.getCookie("userguestid"),a=window.downloadUrl+"?project="+n.toString()
$.ajax({url:"https://www.onlinelogomaker.com/version2_scripts/SaveUserZip.php",type:"POST",data:{zip:o.zip,userid:n},async:!1,success:function(e){$.post("https://www.onlinelogomaker.com/version2_scripts/downloademail_templated.php",{userid:n,ispremium:"1",emailTemplateIndex:window.emailTemaplateIndex,projecturl:a},function(e){t||$("#saved-modal-cover").show(),glassLoader.stop()}),glassLoader.stop()},error:function(e){glassLoader.stop()}}),t||$("#saved-modal-cover").show(),glassLoader.stop()})}()}),ga("send","event","IfPreviewGenerated","Yes",{nonInteraction:1})}var s=Tools.getCookie("userguestid")
$("#url-to-copy").val(window.downloadUrl+"/?project="+s.toString()),$("#test-id").text(s.toString()),$.ajax({type:"POST",url:g,id:s,dataType:"json",data:u,beforeSend:function(e,t){n.allCalls.push(e)},headers:{"Content-Type":"text/plain"},processData:!1}).then(function(e){}).fail(function(){}),$.ajax({type:"POST",url:m,id:s,dataType:"json",data:f,beforeSend:function(e,t){n.allCalls.push(e)},headers:{"Content-Type":"text/plain"},processData:!1}).then(function(e){}).fail(function(){})
var r=window.copy2ctx.canvas,l=document.createElement("canvas")
l.width=300,l.height=r.height*(300/r.width),canvasResize(r,l,e)
var c,r=window.copy2ctx,d=r.canvas,p=document.createElement("canvas")
p.height=d.height,p.width=d.width,p.getContext("2d").drawImage(d,0,0)
var h=new JSZip,c=p.toDataURL("png")
c=c.replace("data:image/png;base64,","")
var v=c,y=c,s=Tools.getCookie("userguestid")
if(a){var b=document.getElementById("grid").backgroundColor
b||(b="#FFF"),$.ajax({type:"POST",url:"server/php/GetResolution.php",data:{image:c,bgColor:"#FFF"},async:!1}).done(function(e){y=e.imagepng,v=e.imagejpg,o()})}else $.ajax({type:"POST",url:"https://www.onlinelogomaker.com/version2_scripts/CheckPremium.php",data:{userid:s},async:!1}).done(function(e){if("true"==e){var n=document.getElementById("grid").backgroundColor
n||(n="#FFF"),$.ajax({type:"POST",url:"server/php/GetResolution.php",data:{image:c,bgColor:"#FFF"},async:!1}).done(function(e){y=e.imagepng,v=e.imagejpg,o()})}else t||$("#saved-modal-cover").show(),glassLoader.stop()})})},CanvasController.prototype.abortCalls=function(){var e=this
$.each(e.allCalls,function(e,t){t.abort()}),e.allCalls.length=0},CanvasController.prototype.resetProjectName=function(){this.projectDate=new Date},CanvasController.prototype.touchedCanvas=function(){this.touched=!0},CanvasController.prototype.getRectBounds=function(e,t,o,n){for(var a,s,i=canvas.getWidth(),r=canvas.getHeight(),l=canvas.getContext().getImageData(0,0,i,r),c=l.data.length,d={top:null,left:null,right:null,bottom:null},p=0;p<c;p+=4)0!==l.data[p+3]&&(a=p/4%i,s=~~(p/4/i),null===d.top&&(d.top=s,e&&(d.top+=e)),null===d.left?(d.left=a,t&&(d.top+=t)):a<d.left&&(d.left=a,t&&(d.top+=t)),null===d.right?(d.right=a,o&&(d.right+=o)):d.right<a&&(d.right=a,o&&(d.right+=o)),null===d.bottom?(d.bottom=s+2,n&&(d.bottom+=o)):d.bottom<s&&(d.bottom=s+2,n&&(d.bottom+=o)))
return d},CanvasController}(),ShadowController=function(){function e(t,o){var n=this
this.$scope=t,this.$cmd=o,this.shadowEnabled=!1,this.glowEnabled=!1,this.strokeEnabled=!1,this.selectedObject=null,this.shadowColor="#FFFFFF",e.instance=this,t.$=this,t.shadowEnabled=!1,t.shadowEnabled=!1,t.strokeEnabled=!1,t.direction=45,t.outset=2,msg.on("object-selected",this.onObjectSelected,this),msg.on("paths-selected",this.onObjectSelected,this),msg.on("object-deselected",this.onObjectDeSelected,this),msg.on("deselect-all",this.onObjectDeSelected,this),t.$watch("direction",function(){return n.onChange()}),t.$watch("outset",function(){return n.onChange()}),$("[name='shadow-checkbox']").bootstrapSwitch({state:!1}),$(".object-option .options").hide(),$(".shadow-picker").mlColorPicker({onChange:function(e){n.onColorSelect(e)}}),$(".shadow-picker").click(function(e){$("#mlSelectedColorText").off(),$("#mlColors").off(),window.colorpicker.controller="ShadowController",window.colorpicker.visible=!0
var t=function(){n.onColorChange(this.value)},o=function(){var e,t=$canvas.getActiveDobj()
e="group"==t.raw.type?$canvas.getOriginColorByObj(t.raw,t.id.toString()+0):$canvas.getOriginColorByObj(t.raw,t.id),n.onColorChange(e.shadow.color)}
$("#mlSelectedColorText").on("keyup",t),$("#mlColors").on("mouseleave",o)})}return e.prototype.onColorChange=function(e){$(".shadow-picker").css("background-color","#"+e),$(".shadow-picker").val(e),this.resetColor(e)},e.prototype.onColorSelect=function(e){var t,o=$canvas.getActiveDobj(),n=o.shadow,a=e
if(e.indexOf(",")>-1){var s=rgba2rgb(e)
a=rgb2hex(s)}-1==e.indexOf("#")&&(a="#"+a),n.color=a,n.enabled=!0,"group"==o.raw.type?(t=$.extend(!0,{},$canvas.getOriginColorByObj(o.raw,o.id.toString()+0)),$canvas.setOriginShadowColor(o.raw,o.id.toString()+0,a)):(t=$.extend(!0,{},$canvas.getOriginColorByObj(o.raw,o.id)),$canvas.setOriginShadowColor(o.raw,o.id,a)),t.shadow.enabled=!0,$cmd.run("shadow",o,t.shadow,n),this.shadowColor=e},e.prototype.resetColor=function(e){var t=$canvas.getActiveDobj(),o=$.extend(!0,{},t.shadow),n=e
if(e.indexOf(",")>-1){var a=rgba2rgb(e)
n=rgb2hex(a)}-1==e.indexOf("#")&&(n="#"+n),o.color=n,$canvas.shadow(t,t.shadow,o),this.shadowColor=e},e.prototype.onObjectSelected=function(e){var t=this
if(this.$scope.shadowEnabled=e.shadow.enabled,this.$scope.glowEnabled=e.glow.enabled,$canvas.activePaths.length&&(this.$scope.strokeEnabled=null!=$canvas.activePaths[0].stroke),DomHelper.wrapOverlay("#shadow-pickr-container"),this.$scope.shadowEnabled){DomHelper.removeOverlay(),this.$scope.direction=e.shadow.direction,this.$scope.outset=e.shadow.outset
var o=e.shadow.color
if(o.indexOf(",")>-1){var n=rgba2rgb(o)
o=rgb2hex(n),o="#"+o}$(".shadow-picker").css("background-color",o),$(".shadow-picker").val(o)}setTimeout(function(){t.$scope.$apply()},20)},e.prototype.onObjectDeSelected=function(){this.$scope.shadowEnabled=!1,$(".shadow-picker").css("background-color","#ccc"),$(".shadow-picker").val("#ccc")},e.prototype.onChange=function(){var e=$canvas.children.length
if(e&&(e=$canvas.getActiveDobj(),this.$scope.shadowEnabled)){var t=$.extend(!0,{},e.shadow),o=this.$scope.direction/180*Math.PI
t.offsetX=Math.cos(o)*this.$scope.outset,t.offsetY=Math.sin(o)*this.$scope.outset,t.direction=this.$scope.direction,t.outset=this.$scope.outset,$cmd.run("shadow",e,e.shadow,t)}},e.prototype.showOption=function(e,t){$(".options").show(),$(".options > div").each(function(){$(this).hide()}),$(".effect-4 li.effect").each(function(){$(this).parent().removeClass("effect-active")}),$(".object-option .options "+t).show(),$(e.currentTarget).parent().addClass("effect-active")},e.prototype.onOnOffShadow=function(e){var t=$canvas.getActiveDobj(),o=$.extend(!0,{},t.shadow)
o.enabled=this.$scope.shadowEnabled,this.$scope.shadowEnabled?$(".shadow-position").removeAttr("disabled").css("color","black"):$(".shadow-position").attr("disabled","disabled").css("color","grey"),this.$scope.direction=45,this.$scope.outset=2,this.$scope.direction=t.shadow.direction,this.$scope.outset=t.shadow.outset,$cmd.run("shadow",t,t.shadow,o)
var n=o.color;-1==o.color.indexOf("#")&&(n=rgba2rgb(o.color),n="#"+rgb2hex(n)),$(".shadow-picker").css("background-color",n),$(".shadow-picker").val(n)},e.prototype.onOnOffGlow=function(){var e=$canvas.getActiveDobj(),t=$.extend(!0,{},e.glow)
t.enabled=this.$scope.glowEnabled,$cmd.run("glow",e,e.glow,t)},e.prototype.onOnOffStroke=function(e){var t="#000"
this.$scope.strokeEnabled||(t=null),$cmd.run("stroke",null,t)},e}(),AddTextController=function(){function e(e){var t=this
this.$scope=e,container=$(".upper-canvas"),e.text="",e.visible=!1,this.fontLoaded=!1,this.textActive=!1,e.$=this,$(document).mouseup(function(e){container.is(e.target)||0!==container.has(e.target).length||($(".upper-canvas").removeClass("cursor-overwrite"),t.textActive=!1)}),msg.on("open-addtext",this.open,this),msg.on("close-popups",this.close)}return e.prototype.open=function(){this.fontLoaded?(this.$scope.visible=!0,this.$scope.text=""):(msg.send("loadfont"),this.open())},e.prototype.close=function(){document.getElementById("downloadLogo-modal").style.display="none"},e.prototype.onCancelClick=function(){this.$scope.visible=!1,msg.send("close-popups")},e.prototype.onOkClick=function(e){e&&(this.$scope.text=Tools.translateText("Enter-a-text-text")),this.$scope.visible=!1,msg.send("add-text",this.$scope.text),msg.send("close-popups")},e}(),NewLogoController=function(){function e(t){e.instance=this,this.$scope=t,t.$=this}return e.prototype.onOkClick=function(){$canvas.removeAll(),ga("send","event","App Click","New Button","New Button Clicked"),msg.send("reset-project-name"),msg.send("clear-history"),msg.send("touchedCanvas"),msg.send("on-grid-click",!1,disable=!0),$(".background-picker div").css("background-color","#ffffff")},e.prototype.onCloseClick=function(){},e}(),ModifyController=function(){function e(e,t){this.$scope=e,this.$cmd=t,this.step=2,this.factor=1.01,this.angle=2,e.$=this}return e.prototype.moveUp=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,0,-2)},e.prototype.moveDown=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,0,2)},e.prototype.moveLeft=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,-2,0)},e.prototype.moveRight=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&this.$cmd.run("move",e,2,0)},e.prototype.zoomIn=function(){var e=$.extend(!0,{},$canvas.getActiveDobj()),t=$canvas.getActiveDobj(),o={x:e.raw.getScaleX(),y:e.raw.getScaleY()},n={x:this.factor*t.raw.getScaleX(),y:this.factor*t.raw.getScaleY()}
this.$cmd.run("scale",t,o,n,t.raw.left,t.raw.top)},e.prototype.zoomOut=function(){var e=$.extend(!0,{},$canvas.getActiveDobj()),t=$canvas.getActiveDobj(),o={x:e.raw.getScaleX(),y:e.raw.getScaleY()},n={x:1/this.factor*obj.getScaleX(),y:1/this.factor*obj.getScaleY()}
this.$cmd.run("scale",t,o,n,t.raw.left,t.raw.top)},e.prototype.rotateCW=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&$cmd.run("rotate",e,this.angle)},e.prototype.rotateCCW=function(){var e=$canvas.getActiveDobj()
Object.keys($canvas.getActiveDobj()).length&&$cmd.run("rotate",e,-this.angle)},e.prototype.duplicate=function(){$cmd.run("duplicate")},e}(),LoginController=function(){function e(e,t){this.$scope=e,this.$http=t,this.$scope.$=this,this.GET_USER_URL="https://www.onlinelogomaker.com/version2_scripts/GetUser.php",this.LOGIN_URL="https://www.onlinelogomaker.com/version2_scripts/DoLogin.php",this.LOGIN_URL="https://www.onlinelogomaker.com/version2_scripts/DoLogin.php",this.REGISTER_USER="https://www.onlinelogomaker.com/version2_scripts/RegisterFreeUser.php",this.LOGOUT_URL="https://www.onlinelogomaker.com/version2_scripts/DoLogout.php",this.registering=!1,e.fromDownload=!1,e.rememberCheck=!1,e.logged=!1,e.isPremium=!1,window.flag=!0,window.logged=!1,window.user={},t.defaults.headers.common["Access-Control-Allow-Headers"]="*",$("#olm-login-area").click(function(){msg.send("remove-opacity-all"),canvas.discardActiveObject()})
var o=Tools.getCookie("useremail")
""!=o?($("#remember-me-check-box").attr("checked",!0),this.$scope.username=o):$("#remember-me-check-box").attr("checked",!1),msg.on("login-event",this.loginPromise,this),msg.on("toggle-register",this.toggleRegister)}return e.prototype.init=function(){var e=(new validator(this.$scope.username),new validator(this.$scope.password),this)
$.post(this.GET_USER_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
try{-1==n.root.user.id?(e.$scope.logged=!1,window.logged=!1,e.$scope.isPremium=!1,e.$scope.$apply(),$(".sk-circle").hide(),$("#email-error-text").hide()):(e.$scope.userfullname=n.root.user.name,e.$scope.user=n.root.user,e.$scope.logged=!0,$(".sk-circle").hide(),$("#email-error-text").hide(),window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),setTimeout(function(){e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname)},1e3))}catch(e){console.error(e)}},"xml")},e.prototype.loginPromise=function(){var e=this
new validator(this.$scope.username),new validator(this.$scope.password)
return new Promise(function(t,o){void 0==this.GET_USER_URL&&(this.GET_USER_URL="https://www.onlinelogomaker.com/applet_scripts/GetUser.php"),$.post(this.GET_USER_URL,{username:e.$scope.username,password:e.$scope.password},function(o,n){var a=JSON.parse(xml2json(o,""))
try{-1==a.root.user.id?(e.$scope.logged=!1,window.logged=!1,e.$scope.$apply()):(e.$scope.userfullname=a.root.user.name,e.$scope.user=a.root.user,e.$scope.logged=!0,window.logged=!0,window.user=a.root.user,e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname)),t(1)}catch(e){console.error(e),t(0)}},"xml")})},e.prototype.fakeLoginPromise=function(){return new Promise(function(e,t){e(1)})},e.prototype.enterOnModal=function(){window.flag?this.onRegisterClick():this.onLoginClickModal()},e.prototype.forgotPasswordClick=function(){open(Tools.translateText("lost-password-text"),"_blank")},e.prototype.domainPopUpClose=function(){ga("send","event","App Click","Claim Domain Click","Pop up close")},e.prototype.onLoginClick=function(){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.username),new validator(this.$scope.password)
if(void 0!==this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),void 0!==this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),t)return $("#email-error-text").show(),void $("#email-error-text").text(o)
$(".sk-circle").show(),$("#email-error-text").hide(),$.post(this.LOGIN_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
n.error?(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$("#email-error-text").show(),$("#email-error-text").text("Invalid username or password."),e.$scope.logged=!1,e.$scope.isPremium=!1,e.$scope.$apply(),ga("send","event","App Click","Login button clicked","Login failed"),window.logged=!1):n.root&&(e.$scope.userfullname=n.root.user.name,e.$scope.logged=!0,window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),ga("send","event","App Click","Login button clicked","Login sucessful"),$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),msg.send("save-project-popup"))},"xml")},e.prototype.onLoginClickLeftMenu=function(){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.username),new validator(this.$scope.password)
if(void 0!==this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),void 0!==this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),t)return void window.alert(o)
$("#email-error-text").hide(),$.post(this.LOGIN_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
n.error?(msg.send("open-popup"),msg.send("open-invalid-user-pass"),window.alert(Tools.translateText("invalid-user-pass-text")),e.$scope.logged=!1,e.$scope.isPremium=e.userIsPremium(),e.$scope.$apply(),ga("send","event","App Click","Login button clicked","Login failed"),window.logged=!1):n.root&&(e.$scope.userfullname=n.root.user.name,e.$scope.logged=!0,window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),ga("send","event","App Click","Login button clicked","Login sucessful"),$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),msg.send("save-project-popup"))},"xml")},e.prototype.onLoginClickModal=function(){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.username),new validator(this.$scope.password)
if(void 0!==this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),void 0!==this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),t)return $("#email-error-text").show(),void $("#email-error-text").text(o)
$(".sk-circle").show(),$("#email-error-text").hide(),$.post(this.LOGIN_URL,{username:this.$scope.username,password:this.$scope.password},function(t,o){var n=JSON.parse(xml2json(t,""))
n.error?(msg.send("open-popup"),msg.send("open-invalid-user-pass"),$(".sk-circle").hide(),$("#email-error-text").show(),$("#email-error-text").text("Invalid username or password."),ga("send","event","App Click","Login button clicked","Login failed"),e.$scope.logged=!1,e.$scope.isPremium=!1,e.$scope.$apply(),window.logged=!1):n.root&&(e.$scope.userfullname=n.root.user.name,e.$scope.logged=!0,window.logged=!0,window.user=n.root.user,e.$scope.isPremium=e.userIsPremium(),ga("send","event","App Click","Login button clicked","Login sucessful"),$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),$("#save-modal").hide(),$("#save-modal-2").hide(),$(".sk-circle").hide(),window.fromDownload?(msg.send("open-popup","downloadlogo"),msg.send("save-project",!0,!0)):msg.send("save-project-popup",!0,!1))},"xml")},e.prototype.registerButton=function(){msg.send("close-popups"),msg.send("open-popup"),window.fromDownload=!1,$("#save-modal-2").show(),this.toggleRegister()},e.prototype.onRegisterClick=function(){var e=this
if(!this.registering){var e=this,t=!1,o=""
$(".auth-content").html("")
new validator(this.$scope.userfullname),new validator(this.$scope.username),new validator(this.$scope.password)
if(Tools.validateEmail(this.$scope.username)||(t=!0,o=Tools.translateText("email-error-text")),void 0!==this.$scope.userfullname?0==this.$scope.userfullname.length&&(t=!0,o="Enter your name"):(t=!0,o="Enter your name"),void 0!==this.$scope.password?0==this.$scope.password.length&&(t=!0,o=Tools.translateText("enter-password-text")):(t=!0,o=Tools.translateText("enter-password-text")),void 0!==this.$scope.username?0==this.$scope.username.length&&(t=!0,o=Tools.translateText("enter-user-text")):(t=!0,o=Tools.translateText("enter-user-text")),t)return $("#email-error-text").show(),void $("#email-error-text").text(o)
var e=this
$(".sk-circle").show(),$("#email-error-text").hide(),$.post("/register",{"form[username]":this.$scope.userfullname,"form[email]":this.$scope.username,"form[password]":this.$scope.password,"form[formId]":"4"},function(t,o,n){if(t.search("Free account")>=0)ga("send","event","App Click","Register button clicked","Registration successful"),$(".sk-circle").hide(),$("#save-modal").hide(),$("#save-modal-2").hide(),e.registering=!1,e.$scope.logged=!0,window.logged=!0,window.user=e.$scope.userfullname,$("#remember-me-check-box").is(":checked")&&Tools.createCookie("useremail",e.$scope.username.toString(),500),e.$scope.$apply(),e.setMenuTexts(e.$scope.userfullname),window.fromDownload?(msg.send("save-project",!0,!0),msg.send("open-popup","downloadlogo")):msg.send("save-project",!0,!1)
else{var a=t.search("This email is already registered."),s=Tools.translateText("something-went-wrong-text")
a>=0&&(s=Tools.translateText("email-already-registered")),ga("send","event","App Click","Register button clicked","Error User Registration"),$(".sk-circle").hide(),e.registering=!1,$("#email-error-text").show(),$("#email-error-text").text(s)}})}},e.prototype.toggleLogin=function(){Tools.getQueryParameters("s")
$("#email-error-text").hide(),$("#fullname-placeholder-text").hide(),$("#fullname-placeholder-text-2").hide(),$("#forgot-text").show(),$("#register-btn").hide(),$("#login-btn").show(),$("#register-btn-2").hide(),$("#login-btn-2").show(),window.fromDownload?$("#login-btn").text(Tools.translateText("download-text")):($("#login-btn").text(Tools.translateText("login-btn")),$("#login-btn-2").text(Tools.translateText("login-btn"))),$("#click-log-in-text").text(Tools.translateText("sign-up-free")),$("#create-account-text").text(Tools.translateText("sign-in-text")),$("#create-account-text-2").text(Tools.translateText("sign-in-text")),$("#click-log-in-text-2").text(Tools.translateText("sign-up-free")),$("#click-log-in-text-2").text(Tools.translateText("sign-up-free-alt")),$("#have-account-text").text(Tools.translateText("dont-have-an-account-text")),window.flag=!1},e.prototype.toggleRegister=function(){Tools.getQueryParameters("s")
$("#email-error-text").hide(),$("#forgot-text").hide(),$("#fullname-placeholder-text").show(),$("#fullname-placeholder-text-2").show(),$("#register-btn").show(),$("#login-btn").hide(),$("#register-btn-2").show(),$("#login-btn-2").hide(),window.fromDownload?$("#register-btn").text(Tools.translateText("download-text")):($("#register-btn").text(Tools.translateText("register-btn")),$("#register-btn-2").text(Tools.translateText("register-btn"))),$("#have-account-text").text(Tools.translateText("have-account-text")),$("#click-log-in-text").text(Tools.translateText("click-log-in-text")),$("#create-account-text-2").text(Tools.translateText("create-account-text")),$("#create-account-text").text(Tools.translateText("create-account-text")),$("#click-log-in-text-2").text(Tools.translateText("click-log-in-text")),window.flag=!0},e.prototype.onToggleRegistration=function(){var e=this
window.flag?e.toggleLogin():e.toggleRegister()},e.prototype.onBecomePremiumClick=function(){open(Tools.translateText("olm-become-premium-url"),"_blank")},e.prototype.onBecomePremiumClickModal=function(){open(Tools.translateText("olm-become-premium-url-alt"),"_blank")},e.prototype.onCloseClick=function(){var e=this
window.fromDownload=!1,$("#email-error-text").hide(),$("#sk-circle").hide(),$("save-modal").hide(),$("#save-modal-2").hide(),$("#logged-in-modal").hide(),e.$scope.userfullname="",e.$scope.username="",e.$scope.password=""},e.prototype.onLogoutClick=function(){var e=this
$.post(this.LOGOUT_URL,function(t,o){e.$scope.logged=!1,e.$scope.user=null,e.$scope.isPremium=!1,e.$scope.userfullname="",e.$scope.username="",e.$scope.password="",e.$scope.$apply(),window.logged=!1,window.user={}}),$(".sk-circle").hide(),$("#email-error-text").hide()},e.prototype.previewCloseClicked=function(){Tools.showDomainPopUp()},e.prototype.claimDomainClick=function(){Math.random()
window.open("https://www.bluehost.com/track/nextnetmedia/HOTH","_blank"),ga("send","event","App Click","Claim Domain Click","Click Open")},e.prototype.onAccountClick=function(){open(Tools.translateText("my-account-url-text"),"_blank")},e.prototype.onFacebookClick=function(){ga("send","event","App Click","Share Symbol Popup Open","Share Facebook"),open("https://www.facebook.com/sharer/sharer.php?s=100&p[url]=http://bit.ly/6ljInp&p[images][0]=http://www.onlinelogomaker.com/images/favicon-cropped128.png&p[title]=Create+your+own+logo+for+free&p[summary]=Create%20your%20own%20logo%20now%20using%20Online%20Logo%20Maker!","fbShareWindow","height=450, width=550, top="+($(window).height()/2-275)+", left="+($(window).width()/2-225)+", toolbar=0, location=0, menubar=0, directories=0, scrollbars=0")},e.prototype.onTwitterClick=function(){ga("send","event","App Click","Share Symbol Popup Open","Share Twitter"),open("https://twitter.com/intent/tweet?original_referer=&source=tweetbutton&text=RT+Create+cool+logos+for+free!&url=http://www.onlinelogomaker.com/&via=rlopes528","twitterShareWindow","height=450, width=550, top="+($(window).height()/2-275)+", left="+($(window).width()/2-225)+", toolbar=0, location=0, menubar=0, directories=0, scrollbars=0")},e.prototype.onCloseShareClick=function(){Tools.showDomainPopUp()},e.prototype.onOkClick=function(){this.$scope.visible=!1,$("#id-auth").hide(),msg.send("close-popups")},e.prototype.setMenuTexts=function(e){$("#welcome-user-text").text()
$("#welcome-user-text").text(Tools.translateText("welcome-user-text")+", "+e),$("#my-account-menu-text").text(Tools.translateText("my-account-menu-text")),$("#logout-text").text(Tools.translateText("logout-text")),$("#free-account-text").text(Tools.translateText("free-account-text")),$("#olm-become-premium-button").text(Tools.translateText("olm-become-premium-button"))},e.prototype.userIsPremium=function(){return"1"===window.user.premium_status},e}(),ObjectsController=function(){function e(t){var o=this
this.$scope=t,this.items=[],this.selectedIndex=-1,e.instance=this,t.$=this,msg.on("object-added",this.onObjectAdd,this),msg.on("object-selected",this.onObjectSelected,this),msg.on("object-move-up",this.onObjectMoveUp,this),msg.on("object-move-down",this.onObjectMoveDown,this),msg.on("object-single-delete",this.onDeleteClick,this),msg.on("object-multiple-delete",this.onDeleteAllClick,this),msg.on("deselect-all",this.clearSelection,this),t.items=$canvas.children,t.sortableOptions={start:function(e,t){o.selectItem(t.item.sortable.index)},containment:"window",stop:function(e,t){for(var o=$canvas.children.length-1;o>=0;o--)$canvas.children[o].raw.moveTo($canvas.children.length-o)}}}return e.prototype.onObjectMoveUp=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t>0){$canvas.children.move(t,t-1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())+1)
break}},e.prototype.onObjectMoveDown=function(e){for(var t=0;t<$canvas.children.length;t++)if($canvas.children[t].selected&&t<$canvas.children.length-1){$canvas.children.move(t,t+1),canvas.getActiveObject().moveTo($canvas.getObjZindex($canvas.getActiveObj())-1)
break}},e.prototype.selectItem=function(e){$canvas.select($canvas.children[e])},e.prototype.onItemClick=function(e){this.selectItem(e)},e.prototype.onItemDoubleClick=function(e,t){msg.send("open-popup","rename")},e.prototype.onObjectAdd=function(e){var t=new DisplayObject
t.raw=e,this.items.unshift(t),t.name="OBJECT "+this.items.length,this.selectObject(e,!0)},e.prototype.onMoveUpClick=function(){this.onObjectMoveUp(this)},e.prototype.onMoveDownClick=function(){this.onObjectMoveDown(this)},e.prototype.selectObject=function(e,t){for(var o=0;o<$canvas.children.length;o++)$canvas.children[o].selected=!1,$canvas.children[o].raw==e.raw&&($canvas.children[o].selected=t,o)},e.prototype.onObjectSelected=function(t){if(canvas.getObjects().length<=1)$("#id-zindex-buttonbar").hide()
else{var o=canvas.getActiveObject(),n=canvas.getObjects().indexOf(o),a=0===n,s=n==canvas.getObjects().length-1
$("#id-zindex-buttonbar").show(),$("#id-bringforward-btn").prop("disabled",s),$("#id-sendbackwards-btn").prop("disabled",a),$("#bring-forward-btn").prop("disabled",a),$("#send-backwards-btn").prop("disabled",s)}e.instance
this.selectObject(t,!0),this.update()},e.prototype.onSelectionCleared=function(e){_this.selectObject(e.target,!1),scopeApply(_this.$scope)},e.prototype.clearSelection=function(){},e.prototype.update=function(){for(var e=canvas.getActiveObject(),t=0;t<this.items.length;t++)this.items[t].selected=this.items[t].raw==e
var o=canvas.getActiveGroup()
if(o){var n=o.getObjects()
for(t=0;t<n.length;t++)this.selectObject(n[t],!0)}},e.prototype.onRenameClick=function(){msg.send("open-popup","rename")},e.prototype.removeObj=function(){msg.send("remove-object")},e.prototype.onDeleteClick=function(){this.removeObj()},e.prototype.removeAllObj=function(){msg.send("remove-objects")},e.prototype.onDeleteAllClick=function(){this.removeAllObj()},e}(),PopupController=function(){function e(e){this.id="",this.$scope=e,e.$=this,e.visible=!1,$("#id-auth").hide()}return e.prototype.init=function(e){this.id=e,msg.on("open-"+e,this.open,this),msg.on("close-"+e,this.open,this)},e.prototype.open=function(){this.$scope.visible=!0},e.prototype.close=function(){this.$scope.visible=!1,msg.send("close-popups")},e}(),DownloadLogoController=function(){function DownloadLogoController($scope,$http){DownloadLogoController.instance=this
var thisRoot=this
this.$scope=$scope,this.lInstance=new LoginController($scope,$http,this),this.originCanvas={},this.originObjPosition={},this.originObjScale={},this.originBounds={},this.alreadyClicked=!1,this.originWidth=0,this.originHeight=0,this.scaleRatioW=1,this.scaleRatioH=1,this.aspectRatioW=1,this.aspectRatioH=1,this.width=0,this.height=0,this.inputWidth=0,this.inputHeight=0,this.isPremium=!1,this.$scope.payments="Card",this.$scope.paymentsNewFlow="Card",this.downloadInterval=null,this.percentageInterval=null,this.htmlWidth=$(".downloadLogo-modal .width"),this.htmlHeight=$(".downloadLogo-modal .height"),this.htmlShareModal=$("#share-modal"),this.constrainProportions=!0,this.useWorkingAreaColor=!1,$scope.text="",$scope.visible=!1,$scope.$=this,this.count=!0,msg.on("open-downloadlogo",this.prepare,this),msg.on("downloadlogo-prepared",this.open,this),msg.on("zip-complete",this.zipComplete,this),msg.on("download-complete",this.downloadComplete,this),msg.on("on-esc-key-click",this.onEscKeyClick,this),Tools.blockPremiumSwitches(),Tools.initSwitches(),this.htmlWidth.bind("keyup mouseup",function(e){if(thisRoot.constrainProportions&&thisRoot.htmlWidth.val()>10){var t=Math.round(thisRoot.htmlWidth.val()*thisRoot.aspectRatioW)
thisRoot.height=t,thisRoot.htmlHeight.val(t)}}),this.htmlHeight.bind("keyup mouseup",function(e){if(thisRoot.constrainProportions&&thisRoot.htmlHeight.val()>10){var t=Math.round(thisRoot.htmlHeight.val()*thisRoot.aspectRatioH)
thisRoot.width=t,thisRoot.htmlWidth.val(t)}}),$scope.keys=[],$scope.keys.push({code:37,action:function(){}}),$scope.keys.push({code:39,action:function(){}}),$scope.$on("keydown",function(e,t){var o=t.code
$scope.keys.forEach(function(e){e.code===o&&(e.action(),$scope.$apply())})}),null==eval(window.localStorage.getItem("downloadCounter"))&&window.localStorage.setItem("downloadCounter",0)}return DownloadLogoController.prototype.setDownloadProportions=function(){$canvas.selectAll(),this.inputWidth=this.htmlWidth.val(),this.inputHeight=this.htmlHeight.val(),this.scaleRatioW=this.inputWidth/this.originWidth,this.scaleRatioH=this.inputHeight/this.originHeight,canvas.setWidth(canvas.width+this.width),canvas.setHeight(canvas.height+this.height),document.getElementById("grid").width=canvas.getWidth(),document.getElementById("grid").height=canvas.getHeight(),$canvas.getActiveGroup().set({scaleX:this.scaleRatioW,scaleY:this.scaleRatioH,left:canvas.width/2,top:canvas.height/2,originX:"center",originY:"center"})},DownloadLogoController.prototype.directDownload=function(){window.flag=!0,$("#downloadLogo-modal-2").hide(),msg.send("open-popup","downloadlogo")},DownloadLogoController.prototype.GetPremiumClick=function(){window.open("https://www.onlinelogomaker.com/buy-premium/subscribe-to/1-online-logo-maker-premium-access?new=1&variation=103","_blank").focus()},DownloadLogoController.prototype.onBecomePremiumClickModal=function(){ga("send","event","App Click","Card Click","Become Premium user click")
var e=this
if(!this.alreadyClicked){this.alreadyClicked=!0
var t=Tools.getCookie("userguestid")
if(""==t){var o=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",o,260),t=Tools.getCookie("userguestid")}ga("send","event","Payment Event","Payment Clicked","User clicked on payment button")
var n=StripeCheckout.configure({key:"pk_live_idAKobErYpBZoLccpLH2n7ym",image:"https://assets.onlinelogomaker.com/images/stripe_logo.png",locale:"auto",token:function(o){$.ajax({url:"https://www.onlinelogomaker.com/version2_scripts/StripeFrontEndPayment.php",type:"post",data:{tokenid:o.id,email:o.email,amount:$currencyService.currentValuesStripe,userid:t,currency:$currencyService.currentCurrency},success:function(n){if("true"==n.status){$("#downloadLogo-select-payment-modal-cover").hide(),$("#downloadLogo-modal-upgrade").hide(),msg.send("save-project",!0,!1),e.alreadyClicked=!1
t.toString()
ga("send","event","Payment Event","Payment Sucessful","Credit Card"),"en"==window.lang&&ga("send","event","Payment Event","Payment Comparison","Credit Card Payment Normal version")}else $("#credit-card-error").text(Tools.translateText(n.message)),$("#payment-error-logo-modal").show(),e.alreadyClicked=!1,ga("send","event","Payment Event","Payment Refused",o.email)},error:function(t){ga("send","event","Payment Event","Error on the server","Error on the server"),alert("Credit Card Error!"),e.alreadyClicked=!1,console.log(t)}})}})
n.open({name:"OnlineLogoMaker",description:"Premium package",zipCode:!0,amount:$currencyService.currentValuesStripe,currency:$currencyService.currentCurrency,billingAddress:!1,closed:function(){e.alreadyClicked=!1}}),window.addEventListener("popstate",function(){n.close()})}},DownloadLogoController.prototype.onBecomePremiumClick=function(){var e=Tools.getCookie("userguestid")
if(""==e){var t=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",t,260),e=Tools.getCookie("userguestid")}var o=$("#email-input-box").val(),n="www.onlinelogomaker.com/logomaker/?project="+e.toString()
$("#download-email-error-text").hide(),Tools.validateEmail(o)?$.post("https://www.onlinelogomaker.com/version2_scripts/downloademail.php",{email:o,userid:e,ispremium:"0",projecturl:n},function(e){1==e.status?($("#downloadLogo-modal-upgrade").hide(),$("#download-email-error-text").hide(),msg.send("save-project",!0,!1)):($("#download-email-error-text").text(Tools.translateText(e.message)),$("#download-email-error-text").show())}):($("#download-email-error-text").text(Tools.translateText("invalid-email-address")),$("#download-email-error-text").show())},DownloadLogoController.prototype.sendPaypalEmail=function(){var e=$("#email-input-box-paypal").val()
if(Tools.validateEmail(e)){var t=Tools.getCookie("userguestid")
if(""==t){var o=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",o,260),t=Tools.getCookie("userguestid")}$.ajax({url:"https://www.onlinelogomaker.com/version2_scripts/MakePremium.php",type:"post",data:{email:e,amount:$currencyService.currentValuesStripe,userid:t,currency:$currencyService.currentCurrency},success:function(e){$("#paypal-completed-premium-modal").hide(),msg.send("save-project",!0,!1)},error:function(e){ga("send","event","Payment Event","Error on the server","Error on the server"),alert("Credit Card Error!"),_this.alreadyClicked=!1,console.log(e)}})}else $("#paypal-email-modal-error-text").text(Tools.translateText("invalid-email-address")),$("#paypal-email-modal-error-text").css("visibility","visible"),$("#paypal-email-modal-error-text").css("height","20px")},DownloadLogoController.prototype.freeDownload=function(){var e=Tools.getCookie("userguestid")
if(""==e){var t=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",t,260),e=Tools.getCookie("userguestid")}var o=$("#email-input-box").val(),n="https://www.onlinelogomaker.com/logomaker/?project="+e.toString()
$("#download-email-error-text").css("visibility","hidden"),Tools.validateEmail(o)?($("#download-email-error-text").css("visibility","visible"),$("#download-email-error-text").text(Tools.translateText("validating-email")),ga("send","event","Payment Event","Payment Comparison","Free Download Old Flow"),$.post("https://www.onlinelogomaker.com/version2_scripts/downloademail.php",{email:o,userid:e,ispremium:"0",projecturl:n},function(e){1==e.status?($("#downloadLogo-modal-upgrade").hide(),$("#download-email-error-text").css("visibility","hidden"),msg.send("save-project",!0,!1),ga("send","event","App Click","Download Free Email sent","Email:"+o.toString())):($("#download-email-error-text").text(Tools.translateText(e.message)),$("#download-email-error-text").css("visibility","visible"),ga("send","event","App Click","Download Email Error","Email Error"))})):($("#download-email-error-text").text(Tools.translateText("invalid-email-address")),$("#download-email-error-text").css("visibility","visible"))},DownloadLogoController.prototype.SaveUserEmail=function(){var e=$("#download-email-input-box").val(),t=!0
window.skip&&(t=!1),Tools.validateEmail(e)?($("#spinner-email-modal").show(),$("#there-was-an-error").hide(),setTimeout(function(){t?($("#spinner-email-modal").hide(),$("#downloadLogo-emails-modal-cover").hide(),$("#downloadLogo-select-format-modal-cover").show(),msg.send("save-project",!0,!0)):($("#spinner-email-modal").hide(),$("#downloadLogo-emails-modal-cover").hide(),msg.send("save-project",!0,!1))},3e3)):($("#there-was-an-error").text(Tools.translateText("invalid-email-address")),$("#there-was-an-error").show())},DownloadLogoController.prototype.PayWithCreditCard=function(){ga("send","event","App Click","Card Click","Become Premium user click")
var e=this
if(!this.alreadyClicked){this.alreadyClicked=!0
var t=Tools.getCookie("userguestid")
if(""==t){var o=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",o,260),t=Tools.getCookie("userguestid")}ga("send","event","Payment Event","Payment Clicked","User clicked on payment button")
var n=StripeCheckout.configure({key:"pk_live_idAKobErYpBZoLccpLH2n7ym",image:"https://assets.onlinelogomaker.com/images/stripe_logo.png",locale:"auto",token:function(o){$.ajax({url:"https://www.onlinelogomaker.com/version2_scripts/StripeFrontEndPayment.php",type:"post",data:{tokenid:o.id,email:o.email,amount:$currencyService.currentValuesStripe,userid:t,currency:$currencyService.currentCurrency},success:function(n){if("true"==n.status){$("#downloadLogo-select-payment-modal-cover").hide(),msg.send("save-project",!0,!1),e.alreadyClicked=!1
t.toString()
ga("send","event","Payment Event","Payment Sucessful","Credit Card"),"en"==window.lang&&ga("send","event","Payment Event","Payment Comparison","Credit Card Payment New version")}else $("#credit-card-error").text(Tools.translateText(n.message)),$("#payment-error-logo-modal").show(),e.alreadyClicked=!1,ga("send","event","Payment Event","Payment Refused",o.email)},error:function(t){ga("send","event","Payment Event","Error on the server","Error on the server"),alert("Credit Card Error!"),e.alreadyClicked=!1,console.log(t)}})}})
n.open({name:"OnlineLogoMaker",description:"Premium package",zipCode:!0,amount:$currencyService.currentValuesStripe,currency:$currencyService.currentCurrency,billingAddress:!1,closed:function(){e.alreadyClicked=!1}}),window.addEventListener("popstate",function(){n.close()})}},DownloadLogoController.prototype.SelectLogoFormat=function(){$(".input-box-label").is(":checked")?($("#spinner-logo-format-modal").show(),$("#save-and-continue-modal-error-text").hide(),setTimeout(function(){$("#downloadLogo-select-format-modal-cover").hide(),$("#downloadLogo-select-payment-modal-cover").show(),$currencyService&&($("#second-price").text($currencyService.currentValueNoSign.toString()),$("#first-price").text($currencyService.overPriced.toString())),$("#spinner-logo-format-modal").hide()},3e3)):$("#save-and-continue-modal-error-text").show()},DownloadLogoController.prototype.LowResolutionClick=function(){console.log("LowResolutionClick"),$("#downloadLogo-select-payment-modal-cover").hide(),$("#downloadLogo-low-resolution-download-modal-cover").show()},DownloadLogoController.prototype.DownloadFullRightsClick=function(){$("#downloadLogo-low-resolution-download-modal-cover").hide(),$("#downloadLogo-low-resolution-download-modal-final-cover").hide(),$("#save-and-continue-modal-error-text").hide(),$("#downloadLogo-select-payment-modal-cover").show()},DownloadLogoController.prototype.ProccedtoDownload=function(){$("#downloadLogo-low-resolution-download-modal-cover").hide(),$("#downloadLogo-low-resolution-download-modal-final-cover").show()},DownloadLogoController.prototype.DownloadFreeClick=function(){if($(".input-checkbox-commercial:checked").length<4)$("#download-free-modal-error-text").show(),$("#download-free-modal-error-text").text(Tools.translateText("please-agree-to-all-terms"))
else if($("#agree-low-resolution-download").val().length<=0)$("#download-free-modal-error-text").show(),$("#download-free-modal-error-text").text(Tools.translateText("please-enter-your-name-above"))
else{$("#spinner-logo-low-resolution-download").show(),$("#download-free-modal-error-text").hide()
var e=Tools.getCookie("userguestid")
if(""==e){var t=Math.floor(1e7+9e7*Math.random())
Tools.createCookie("userguestid",t,260),e=Tools.getCookie("userguestid")}var o=$("#download-email-input-box").val(),n="https://www.onlinelogomaker.com/logomaker/?project="+e.toString()
ga("send","event","Payment Event","Payment Comparison","Free Download New Flow"),$.post("https://www.onlinelogomaker.com/version2_scripts/downloademail.php",{email:o,userid:e,ispremium:"0",projecturl:n},function(e){1==e.status?($("#downloadLogo-low-resolution-download-modal-final-cover").hide(),$("#download-free-modal-error-text").hide(),$("#spinner-logo-low-resolution-download").hide(),msg.send("save-project",!0,!1),ga("send","event","App Click","Download Free Email sent","Email:"+o.toString())):($("#download-free-modal-error-text").text(Tools.translateText(e.message)),$("#download-free-modal-error-text").show(),$("#spinner-logo-low-resolution-download").hide(),ga("send","event","App Click","Download Email Error","Email Error"))})}},DownloadLogoController.prototype.downloadLogoPopup=function(){window.flag=!0,msg.send("preview-canvas-fill"),msg.send("download-cancelled")
var e=!1
window.skip&&(e=!0)
var t=Tools.getQueryParameters("project")
if(""!=t&&"p"==t[0])return void msg.send("open-popup","downloadlogo")
var o=Tools.getCookie("userguestid")
e?($("#cover").show(),$("#downloadLogo-emails-modal-cover").show(),msg.send("save-project",!0,!0)):$.ajax({type:"POST",url:"https://www.onlinelogomaker.com/version2_scripts/CheckPremium.php",data:{userid:o},async:!1}).done(function(e){"true"==e?msg.send("save-project",!0,!1,!0):(ga("send","event","Payment Event","Payment Comparison","Showing New Flow"),$("#cover").show(),$("#downloadLogo-emails-modal-cover").show(),msg.send("save-project",!0,!0))})},DownloadLogoController.prototype.openPaymentOptions=function(){$("#drop-down-payments").slideDown("fast",function(){}),$("#drop-down-payments").val("Card"),$("#become-premium-modal").hide(),$("#open-payment-options").show()},DownloadLogoController.prototype.openPaymentOptionsNewFlow=function(){$("#drop-down-payments-new-flow").slideDown("fast",function(){}),$("#drop-down-payments-new-flow").val("Card"),$("#become-premium-modal-new-flow").hide(),$("#pay-with-credit-card").show()},DownloadLogoController.prototype.resetPaymentOptions=function(){$("#drop-down-payments").hide(),$("#become-premium-modal").show(),$("#open-payment-options").hide(),$("#paypal-button-container-upgrade").hide()},DownloadLogoController.prototype.changePayment=function(){var e=$("#drop-down-payments").val()
"Card"==e?($("#paypal-button-container-upgrade").hide(),$("#become-premium-modal").hide(),$("#open-payment-options").show()):"Paypal"==e&&($("#paypal-button-container-upgrade").show(),$("#become-premium-modal").hide(),$("#open-payment-options").hide())},DownloadLogoController.prototype.changePaymentNewFlow=function(){var e=$("#drop-down-payments-new-flow").val()
"Card"==e?($("#paypal-button-container-upgrade-new-flow").hide(),$("#paypal-button-container").hide(),$("#pay-with-credit-card").show()):"Paypal"==e&&($("#paypal-button-container").show(),$("#pay-with-credit-card").hide(),$("#open-payment-options-new-flow").hide())},DownloadLogoController.prototype.openDownloadPage=function(){msg.send("open-download-page")},DownloadLogoController.prototype.prepare=function(){msg.send("prepare-canvas-size","downloadlogo-prepared")},DownloadLogoController.prototype.open=function(){var e=this
if($("#domain-modal").hide(),$("#preview-modal").hide(),"block"!=$("#downloadLogo-modal").css("display")){$canvas.selectAll(),this.originCanvas=window.copy2ctx.canvas
var t=$.extend(!0,{},$canvas.getActiveGroup())
this.originObjPosition={left:t.left,top:t.top},this.originObjScale={scaleX:t.getScaleX(),scaleY:t.getScaleY()},this.$scope.visible=!0,this.$scope.text="",document.getElementById("downloadLogo-modal").style.display="block"
var o=0
$canvas.children.forEach(function(e){e.isCard&&o++}),o>0?$("#preview-download-canvas").hide():$("#preview-download-canvas").show(),this.width=Math.round(this.originCanvas.width),this.height=Math.round(this.originCanvas.height),this.originWidth=this.width,this.originHeight=this.height,this.htmlWidth.val(this.width),this.htmlHeight.val(this.height),this.aspectRatioW=this.height/this.width,this.aspectRatioH=this.width/this.height,this.lInstance.loginPromise().then(function(){window.logged?$.ajax({type:"POST",url:"https://www.onlinelogomaker.com/version2_scripts/isPremium.php",data:{id:window.user.id},success:function(t){parseInt(t)?(ga("send","event","App Click","Download Logo","Premium Download"),e.preparePremiumDownload()):(ga("send","event","App Click","Download Logo","Free Download"),e.prepareFreeDownload())}}).fail(function(){}):(ga("send","event","App Click","Download Logo","Free Download"),e.prepareFreeDownload())})}},DownloadLogoController.prototype.percentageLoader=function(e){var t=this
clearInterval(t.percentageInterval),void 0==e&&(e=10),glassLoader.start(),this.disabledButtons(!0)
var o=0
this.percentageInterval=setInterval(function(){o+=1,o=Math.round(o),o>=100&&(o=100,clearInterval(t.percentageInterval)),$(".downloadLogo-modal .download-info").text(Tools.translateText("please-wait-text")+o+"%").css("color","black"),$(".progress-bar").css("width",o+"%")},e)},DownloadLogoController.prototype.stopPercentageLoader=function(){clearInterval(this.percentageInterval),clearTimeout(this.percentageInterval)},DownloadLogoController.prototype.resetPercentageLoader=function(){$(".downloadLogo-modal .download-info").text(Tools.translateText("please-wait-text")+" 100%").css("color","black"),$(".progress-bar").css("width","100%"),clearTimeout(this.percentageInterval),$(".downloadLogo-modal .download-info").text(Tools.translateText("logo-ready-text")).css("color","white")},DownloadLogoController.prototype.preparePremiumDownload=function(){var e=this
window.downloadFiles=[],this.percentageLoader(30),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!1,e.width=2e3,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),e.downloadInterval=setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.download(isPremium=!0,download=!1),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!0,e.downloadInterval=setTimeout(function(){e.download(isPremium=!0,download=!1),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!1,e.width=500,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),e.downloadInterval=setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.stopPercentageLoader(),e.download(isPremium=!0,download=!0),e.downloadInterval=setTimeout(function(){setCanvasDimensions(),$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current)},100)},100)},500)},300)},100)},100)},1500)},DownloadLogoController.prototype.prepareFreeDownload=function(){var e=this
window.downloadFiles=[],this.percentageLoader(6),e.downloadInterval=setTimeout(function(){e.useWorkingAreaColor=!1,e.width=300,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),e.downloadInterval=setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.stopPercentageLoader(),e.download(isPremium=!1,download=!0),e.downloadInterval=setTimeout(function(){setCanvasDimensions(),$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current)},100)},100)},300)},DownloadLogoController.prototype.resetProportions=function(){$canvas.selectAll(),$canvas.getActiveGroup().set({scaleX:1/this.scaleRatioW,scaleY:1/this.scaleRatioH,left:this.originObjPosition.left,top:this.originObjPosition.top,originX:"center",originY:"center"}),canvas.renderAll(),setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll()},300)},DownloadLogoController.prototype.close=function(){this.$scope.visible=!1,msg.send("close-popups"),this.resetProportions()},DownloadLogoController.prototype.onCancelClick=function(){this.scaleRatioW=1,this.scaleRatioH=1,this.close()},DownloadLogoController.prototype.onPngOkClick=function(){var e=this
setTimeout(function(){e.width=500,e.useWorkingAreaColor=!0,e.height=Math.round(e.width*e.aspectRatioW),e.htmlWidth.val(e.width),e.htmlHeight.val(e.height),setTimeout(function(){canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),e.download(isPremium=!1)},500)},500)},DownloadLogoController.prototype.onSvgOkClick=function(){},DownloadLogoController.prototype.onEscKeyClick=function(){this.htmlShareModal.hide()},DownloadLogoController.prototype.validate=function(){var e=!0,t=""
return this.inputWidth=this.htmlWidth.val(),this.inputHeight=this.htmlHeight.val(),0==this.inputWidth.length&&0==this.inputHeight.length?(e=!1,t="Please enter the desired width and height for your download."):0==this.inputWidth.length?(e=!1,t="Please enter the desired width for your download."):0==this.inputHeight.length&&(e=!1,t="Please enter the desired height for your download."),this.inputWidth.length>5&&(e=!1,t="Maximum width and height allowed for download is: 5000px"),this.inputHeight.length>5&&(e=!1,t="Maximum width and height allowed for download is: 5000px"),e||alert(t),e},DownloadLogoController.prototype.download=function(isPremium,download){var _this=this
if(this.isPremium=isPremium,this.validate()){this.setDownloadProportions(),this.$scope.visible=!1
var padding=20
msg.send("download-canvas",_this.constrainProportions,_this.useWorkingAreaColor,widthPadding=padding,heightPadding=padding,_this.inputWidth,_this.inputHeight,_this.scaleRatioW,_this.scaleRatioH,_this.isPremium,download)}var downloadCounter=eval(window.localStorage.getItem("downloadCounter"))
downloadCounter+=1,window.localStorage.setItem("downloadCounter",downloadCounter)},DownloadLogoController.prototype.disabledButtons=function(e){$(".downloadLogo-modal .body .popup-footer a").each(function(){$(this).attr("disabled",e)}),$(".downloadLogo-modal .body .popup-footer button").each(function(){$(this).attr("disabled",e)}),$("#tools-download-button").attr("disabled",e)},DownloadLogoController.prototype.downloadInprogress=function(){},DownloadLogoController.prototype.downloadComplete=function(){this.resetProportions()},DownloadLogoController.prototype.zipComplete=function(){this.disabledButtons(!1),this.resetPercentageLoader()},DownloadLogoController.prototype.downloadCanceled=function(){clearTimeout(this.downloadInterval),clearTimeout(this.percentageInterval),$(".progress-bar").css("width","100%"),$("#dlink").replaceWith('<a id="dlink" target="_blank" style="display: inline-block;">'+Tools.translateText("wait-text")+"</a>"),this.disabledButtons(!1),$(".downloadLogo-modal .download-info").text(""),canvas.deactivateAllWithDispatch().renderAll(),setCanvasDimensions(),glassLoader.stop(),$("#mask").hide(),$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current),this.count&&(Math.random()>=.2?this.htmlShareModal.show():$("#feedback-modal").show()),this.count=!1},DownloadLogoController}(),ConfirmationController=function(e){function t(t){e.call(this,t),msg.on("open-confirmation",this.open,this)}return __extends(t,e),t.prototype.open=function(){this.$scope.visible=!0,this.$scope.text="",document.getElementById("confirmation-modal").style.display="block"},t.prototype.onYesClick=function(){this.close(),msg.send("confirmation-clicked",!0)},t.prototype.onNoClick=function(){this.close(),msg.send("confirmation-clicked",!1)},t}(PopupController),FontSelectionController=function(e){function t(t){e.call(this,t)
var o=this
this.items=[],this.normalFonts=[],this.originFont="ADAMCG PRO",this.currentIndex=0,this.$scope=t,t.$=this,msg.on("object-selected",this.onObjectSelected,this),$(".dropdown").click(function(){o.currentIndex=0}),t.keys=[],t.keys.push({code:38,action:function(){o.currentIndex>=0&&(o.currentIndex>0&&o.currentIndex--,o.onItemPreview(o.currentIndex))}}),t.keys.push({code:40,action:function(){o.currentIndex<o.items.length-1&&(o.currentIndex++,o.onItemPreview(o.currentIndex))}}),t.$on("keydown",function(e,o){var n=o.code
t.keys.forEach(function(e){e.code===n&&(e.action(),t.$apply())})}),$.get("https://assets.onlinelogomaker.com/fonts/fonts.json?v="+Math.floor(Date.now()/1e3),function(){}).always(function(e){e.hasOwnProperty("normalFonts")&&(o.normalFonts=e.normalFonts),o.init("fontselection"),o.generateFontFaces()})}return __extends(t,e),t.prototype.generateFontFaces=function(){for(var e,t=document.createElement("style"),o=".eot",n=0;n<this.normalFonts.length;n++){e=this.normalFonts[n],this.items.push({name:this.normalFonts[n]});/Trident/.test(window.navigator.userAgent)||(o=".ttf"),t.appendChild(document.createTextNode("                @font-face {                    font-family: '"+e+"';                    src: url('assets/fonts/"+e+o+"') format('truetype');                    text-rendering: optimizeLegibility;                    speak: none;                    font-style: normal;                    font-weight: normal;                    font-variant: normal;                    text-transform: none;                    line-height: 1;                    -webkit-font-smoothing: antialiased;                }            "))}document.head.appendChild(t)},t.prototype.onItemClick=function(e,t){this.currentIndex=e
var o,n,a,s,i=$(t.currentTarget).siblings()
o=$canvas.getActiveDobj(),a=$.extend(!0,{},o),n=this.items[e].name,s=a.font
for(var r=0;r<i.length;r++)i[r].style.backgroundColor=""
this.originFont=n,o.font=n,t.currentTarget.style.backgroundColor="#eee",$cmd.run("text-font",s,n)},t.prototype.onItemPreview=function(e){var t,o,n,a
t=$canvas.getActiveDobj(),n=$.extend(!0,{},t),o=this.items[e].name,a=n.raw.fontFamily,msg.send("text-font",a,o)},t.prototype.onItemReset=function(){msg.send("text-font",this.originFont,this.originFont)},t.prototype.onOkClick=function(){this.close()},t.prototype.onCancelClick=function(){this.close()},t.prototype.onObjectSelected=function(e){e.type==DOType.ITEXT&&(e.font=e.raw.fontFamily)},t}(PopupController),GuidedTourController=function(){function e(e,t){var o=this
this.$scope=e,this.$scope.$=this,this.$http=t,this.previusSelected=null,this.previusSelectedMark=null,e.tourActive=!1,e.addTextFrame=!1,e.addSymbolFrame=!1,e.addfontframe=!1,e.addPalletFrame=!1,e.toolsFrame=!1,e.allSymbols=[],e.allFonts=[],e.allPallets=[],e.loaderTimer=!1,e.fileToolFrame=!1,this.selectedSymbol=0,this.selectedFont=0,this.selectedPallet=0,this.sucessFontIndex=0,this.sucessPalletIndex=0,this.selectedCategory=0,this.selectedCategoryValue="animals",e.textTour="Logo Maker",e.symbolTour="https://assets.onlinelogomaker.com/assets/svg/abstract/Sym-1.svg",this.symbolsRootUrl="https://assets.onlinelogomaker.com/",msg.on("activate-guided-tour",this.activateGuidedTour,this),msg.on("update-size-guided-tour",this.updateSize,this),msg.on("continue-1",this.continue_1,this),msg.on("is-active-guided-tour",this.isActive,this),msg.on("add-symbol-guided-tour",this.addSymbolFromSymbolController,this),$(window).on("resize",function(){msg.send("update-size-guided-tour")}),$("#bussiness-name-input").on("keyup",function(e){13==e.keyCode&&o.continueClick(1)}),$(".olm-gt-symbol").on("dblclick",function(){o.continueClick(2)})}return e.prototype.init=function(){this.updateSize(),this.addTextFrame()},e.prototype.updateSize=function(){if(this.$scope.tourActive){var e=$("#olm-right-navbar").width()+10,t=$(window).width(),o=$("#olm-right-navbar").position(),n=t-e-o.left
$("#olm-gt-filetools-left").css("width",o.left+"px"),$("#olm-gt-filetools").css("width",e+"px"),$("#olm-gt-filetools-right").css("width",n+"px")
var a=parseInt($("#olm-addt").css("height")),s=parseInt($("#olm-adds").css("height")),i=parseInt($("#olm-uplimg").css("height"))
leftPaneOff=$(window).height()-63-15-a-s-i,$("#olm-gt-add-text").css("height",a+"px"),$("#olm-gt-add-symbol").css("height",s+"px"),$("#olm-gt-upload-image").css("height",i+"px"),$("#olm-gt-off").css("height",leftPaneOff+"px")}},e.prototype.activateGuidedTour=function(){this.$scope.tourActive=!0,this.$scope.$apply(),$("#select-category-dropdown").text(Tools.translateText("animals-text")),this.init()},e.prototype.isActive=function(e){e.resp=this.$scope.tourActive},e.prototype.addSymbolFromSymbolController=function(e){$(".olm-guided-tour").css("z-index",1e4),$(".olm-check-symbol").css("display","none"),$("#olm-check-symbol-11").css("display","inherit"),this.$scope.symbolTour=e
var t='<img id="olm-svg-symbol-11" src="'+e+'"></img>'
$("#symbol-11").length&&$("#olm-svg-symbol-11").remove(),$("#symbol-11").append(t),$("#symbol-11").css("border","2px solid #E74C3B")},e.prototype.addMark=function(e){var t=this
null!=t.previusSelected?(t.previusSelectedMark.removeClass("checked"),$("#olm-marked-symbol-"+e.toString()).addClass("checked"),t.previusSelectedMark=$("#olm-marked-symbol-"+e.toString()),t.previusSelected.removeClass("symbols-guide-selected"),$("#symbol-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#symbol-"+e.toString())):($("#symbol-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#symbol-"+e.toString()),$("#olm-marked-symbol-"+e.toString()).addClass("checked"),t.previusSelectedMark=$("#olm-marked-symbol-"+e.toString())),t.selectedSymbol=e},e.prototype.addMarkFont=function(e){var t=this
null!=t.previusSelected?(t.previusSelectedMark.removeClass("checked"),$("#olm-marked-font-"+e.toString()).addClass("checked"),t.previusSelectedMark=$("#olm-marked-font-"+e.toString()),t.previusSelected.removeClass("symbols-guide-selected"),$("#fonts-categories-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#fonts-categories-"+e.toString())):($("#fonts-categories-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#fonts-categories-"+e.toString()),$("#olm-marked-font-"+e.toString()).addClass("checked"),t.previusSelectedMark=$("#olm-marked-font-"+e.toString())),t.selectedFont=e},e.prototype.addMarkPallet=function(e){var t=this
null!=t.previusSelected?(t.previusSelectedMark.removeClass("checked"),$("#olm-marked-pallet-"+e.toString()).addClass("checked"),t.previusSelectedMark=$("#olm-marked-pallet-"+e.toString()),t.previusSelected.removeClass("symbols-guide-selected"),$("#color-pallet-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#color-pallet-"+e.toString())):($("#olm-marked-pallet-"+e.toString()).addClass("checked"),t.previusSelectedMark=$("#olm-marked-pallet-"+e.toString()),$("#color-pallet-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#color-pallet-"+e.toString())),t.selectedPallet=e},e.prototype.addFont=function(e){var t=this
null!=t.previusSelected?(t.previusSelected.removeClass("symbols-guide-selected"),$("#symbol-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#symbol-"+e.toString())):($("#symbol-"+e.toString()).addClass("symbols-guide-selected"),t.previusSelected=$("#symbol-"+e.toString())),t.selectedSymbol=e},e.prototype.moreSymbols=function(){$(".olm-guided-tour").css("z-index",-1),msg.send("open-symbols")},e.prototype.deactivateGuidedTour=function(){this.$scope.tourActive=!1},e.prototype.skipClick=function(){this.deactivateGuidedTour()},e.prototype.addTextFrame=function(){this.$scope.addTextFrame=!0,this.$scope.$evalAsync(),$("#ex1").slider({}),$("#olm-gt-add-text").css("opacity",0)},e.prototype.remAddTextFrame=function(){this.$scope.addTextFrame=!1,this.$scope.$evalAsync(),$("#olm-gt-add-text").css("opacity",1)},e.prototype.addSymbolFrame=function(){this.addGuidedSymbols(),this.$scope.addSymbolFrame=!0,this.$scope.$apply(),this.$scope.$evalAsync(),$("#ex2").slider({}),$("#olm-gt-add-symbol").css("opacity",0)},e.prototype.addFontFrame=function(){this.addGuidedFont(),this.$scope.addFontFrame=!0,this.$scope.addSymbolFrame=!1,this.$scope.$evalAsync(),$("#ex3").slider({}),$("#olm-gt-add-symbol").css("opacity",0)},e.prototype.addColorPallet=function(){this.addColorPallets(),this.$scope.addFontFrame=!1,this.$scope.addPalletFrame=!0,this.$scope.$evalAsync(),$("#ex4").slider({}),$("#olm-gt-add-symbol").css("opacity",0)},e.prototype.remAddSymbolFrame=function(){this.$scope.addSymbolFrame=!1,$("#olm-gt-add-symbol").css("opacity",1)},e.prototype.toolsFrame=function(){this.$scope.toolsFrame=!0,this.$scope.$evalAsync(),$("#olm-gt-add-symbol").css("opacity",0),$("#olm-gt-add-text").css("opacity",0),$("#olm-gt-upload-image").css("opacity",0)},e.prototype.remToolsFrame=function(){this.$scope.toolsFrame=!1,$("#olm-gt-add-symbol").css("opacity",1),$("#olm-gt-add-text").css("opacity",1),$("#olm-gt-upload-image").css("opacity",1)},e.prototype.fileToolFrame=function(){this.$scope.fileToolFrame=!0,$("#olm-gt-filetools").css("opacity",0)},e.prototype.remFileToolFrame=function(){this.$scope.fileToolFrame=!1,$("#olm-gt-right-nav").css("opacity",1)},e.prototype.continueClick=function(e){var t=this
switch(e){case 1:t.$scope.loaderTimer=!0
var o=$("#bussiness-name-input").val()
""!==o?t.$scope.textTour=o:$("#bussiness-name-input").val(t.$scope.textTour),setTimeout(function(){msg.send("continue-1")},1e3),t.$scope.$evalAsync()
break
case 2:t.$scope.loaderTimer=!0,t.sucessFontIndex=0,t.$scope.allFonts.length=0,this.addFontFrame(),t.$scope.$evalAsync()
break
case 3:t.$scope.loaderTimer=!0,t.sucessPalletIndex=0,t.$scope.allPallets.length=0,this.addColorPallet(),t.$scope.$evalAsync()
break
case 4:t.$scope.loaderTimer=!0,this.remAddSymbolFrame(),this.deactivateGuidedTour()
msg.send("add-guided-information",t.$scope.allPallets[t.selectedPallet].meta,window.innerWidth/2,window.innerHeight/2,t.$scope.textTour,t.$scope.allFonts[t.selectedFont].meta,t.$scope.allPallets[t.selectedPallet].background.substr(1),t.$scope.allPallets[t.selectedPallet].fontColor),$canvas.unselectAll(),t.$scope.$evalAsync()}},e.prototype.BackButtonClick=function(e){var t=this
switch(e){case 0:t.$scope.addTextFrame=!0,t.$scope.addSymbolFrame=!1,t.$scope.addFontFrame=!1,t.$scope.addPalletFrame=!1,$("#bussiness-name-input").val(""),t.$scope.allSymbols.length=0
break
case 1:$("#olm-check-symbol-1").css("display","inherit"),t.$scope.addTextFrame=!1,t.$scope.addSymbolFrame=!0,t.$scope.addFontFrame=!1,t.$scope.addPalletFrame=!1,$("#bussiness-name-input").val(""),t.$scope.$evalAsync(),console.log("Back 1")
break
case 2:t.$scope.addTextFrame=!1,t.$scope.addSymbolFrame=!1,t.$scope.addFontFrame=!0,t.$scope.addPalletFrame=!1,t.$scope.allPallets.length=0,console.log("Back 2")}},e.prototype.CategorySelect=function(e,t,o){this.selectedCategory=t,this.selectedCategoryValue=o,$("#select-category-dropdown").text(Tools.translateText(e))},e.prototype.addElementsTour=function(){var e=this
msg.send("add-symbol",e.$scope.symbolTour,10,10),msg.send("add-text",e.$scope.textTour,10,10),setTimeout(function(){canvas.item(1).left=canvas.width/2,canvas.item(1).top=canvas.height/4,canvas.item(0).left=canvas.item(1).left-canvas.item(0).width/2+canvas.item(1).width*canvas.item(1).scaleX/2,canvas.item(0).top=canvas.item(1).top+canvas.item(1).height*canvas.item(1).scaleY,canvas.item(0).setCoords(),canvas.item(1).setCoords()},1e3)},e.prototype.clickSymbol=function(e){var t=e.currentTarget.id,o="#olm-svg-"+t,n="#olm-check-"+t
$(".olm-check-symbol").css("display","none"),$(n).css("display","inherit"),this.$scope.symbolTour=$(o).attr("src")},e.prototype.continue_1=function(){var e=this
this.remAddTextFrame(),this.addSymbolFrame(),e.$scope.allSymbols.length=0,$("#olm-check-symbol-1").css("display","inherit")},e.prototype.getSymbols=function(){return this.$scope.allSymbols},e.prototype.getFonts=function(){return this.$scope.allFonts},e.prototype.getPallets=function(){return this.$scope.allPallets},e.prototype.addGuidedFont=function(){var e=this
e.selectedCategoryValue
$.get("https://assets.onlinelogomaker.com/fonts/fonts.json?v="+Math.floor(Date.now()/1e3),function(){}).always(function(t){if(t.hasOwnProperty("normalFonts"))for(var o=0;o<t.normalFonts.length;o++){var n=new FontFace(Tools.mapOlmFont(t.normalFonts[o]),'url("assets/fonts/'+t.normalFonts[o]+".ttf")
document.fonts.add(n),n.load().then(function(o){var n=e.$scope.allSymbols[e.selectedSymbol].meta
$.ajax({url:n,success:function(o){var n=(new XMLSerializer).serializeToString(o),a=encodeURIComponent(n),s="data:image/svg+xml;charset=utf8,"+a,i=document.createElement("canvas")
i.setAttribute("width",150),i.setAttribute("height",130)
var r=i.getContext("2d"),l=new Image(300,300)
l.src=s
var c=20
for(r.drawImage(l,37.5,27.5,75,75),r.font=c+"px "+Tools.mapOlmFont(t.normalFonts[e.sucessFontIndex]),textWidth=r.measureText(e.$scope.textTour).width;textWidth>135;)c--,r.font=c+"px "+Tools.mapOlmFont(t.normalFonts[e.sucessFontIndex]),textWidth=r.measureText(e.$scope.textTour).width
r.fillText(e.$scope.textTour,75-textWidth/2,120)
var d=i.toDataURL("image/png"),p=d,h={image:p,meta:Tools.mapOlmFont(t.normalFonts[e.sucessFontIndex])}
e.$scope.allFonts.push(h),e.sucessFontIndex++,e.$scope.loaderTimer=!1,e.$scope.$evalAsync()}})})}})},e.prototype.addColorPallets=function(){var e=this
e.selectedCategoryValue
$.get("https://assets.onlinelogomaker.com/color_pallet.json?v="+Math.floor(Date.now()/1e3),function(){}).always(function(t){for(var o=0;o<t.length;o++){var n=e.$scope.allSymbols[e.selectedSymbol].meta
$.ajax({url:n,success:function(o){var n=e.sucessPalletIndex
e.sucessPalletIndex++
var a=Math.floor(Math.random()*t[n].length),s=t[n][a],i=s.toString()
t[n].splice(a,1)
for(var r=(new XMLSerializer).serializeToString(o),l=new DOMParser,c=l.parseFromString(r,"image/svg+xml"),d=c.querySelectorAll("path"),p=0,h=t[n].length,g=[],m=0;m<d.length;m++){for(var u=!1,v=0;v<g.length;v++)g[v]==m&&(u=!0)
if(!u){p>=h-1&&(p=0)
for(var f=t[n][p],w="fill:"+f+";",$=m+1;$<d.length;$++)d[m].style.fill==d[$].style.fill&&(g.push($),d[$].setAttribute("style",w))
d[m].setAttribute("style",w),p++}}var y=(new XMLSerializer).serializeToString(c),b=encodeURIComponent(y),C="data:image/svg+xml;charset=utf8,"+b,x=document.createElement("canvas")
x.setAttribute("width",150),x.setAttribute("height",130)
var k=x.getContext("2d"),S=new Image
S.src=C,S.onload=function(o){k.fillStyle=s,k.fillRect(0,0,150,150),k.drawImage(S,37.5,27.5,75,75),k.font="20px "+e.$scope.allFonts[e.selectedFont].meta
var a=t[n][Math.floor(Math.random()*t[n].length)]
k.fillStyle=a,textWidth=k.measureText(e.$scope.textTour).width
for(var r=20;textWidth>135;)r--,k.font=r+"px "+e.$scope.allFonts[e.selectedFont].meta,textWidth=k.measureText(e.$scope.textTour).width
k.fillText(e.$scope.textTour,75-textWidth/2,120)
var l=x.toDataURL("image/png"),c=l,d={image:c,meta:y,background:i,fontColor:a}
e.$scope.allPallets.push(d),e.$scope.loaderTimer=!1,e.$scope.$evalAsync()}}})}})},e.prototype.addGuidedSymbols=function(){var e=this,t="",o=e.selectedCategoryValue
e.$http.get("https://assets.onlinelogomaker.com/templates/"+o+".json?v="+Math.floor(Date.now()/1e3)).then(function(o){for(var n=0;n<o.data.length;n++){var a={}
a.url=e.symbolsRootUrl+o.data[n].folder+"/"
for(var s=0;s<o.data[n].content.length;s++)t=a.url+o.data[n].content[s].name,$.ajax({url:t,beforeSend:function(e,t){},success:function(t,o,n){var a=this,s=(new XMLSerializer).serializeToString(t),i=encodeURIComponent(s),r="data:image/svg+xml;charset=utf8,"+i,l=new C2S(500,500),c=new Image
c.src=r,c.width="300",c.height="300",c.onload=function(t){l.drawImage(c,100,85),l.font="70px MyriadPro",textWidth=l.measureText(e.$scope.textTour).width
l.fillText(e.$scope.textTour,250-textWidth/2,460)
var o=l.getSerializedSvg(),n=encodeURIComponent(o),s="data:image/svg+xml;charset=utf8,"+n,i={image:s,meta:a.url}
e.$scope.allSymbols.push(i),e.$scope.loaderTimer=!1,e.$scope.$evalAsync()}}})}})},e}(),TextController=function(){function e(t){var o=this
this.$scope=t,this.textcolorTracker=[],ObjectsController.instance=this,e.instance=this,this.primaryColor=void 0,this.primaryColorWasSet=!1,this.primaryColorWasStored=!1,this.oldColor="fff",this.newColor="fff",t.$=this,t.visible=!1,t.font_name="",msg.on("object-selected",this.onObjectSelected,this),msg.on("object-deselected",this.onObjectDeSelected,this),msg.on("deselect-all",this.onObjectDeSelected,this),msg.on("update-text-font",this.fontSelect,this),msg.on("object-bringforward",this.bringForward,this),msg.on("object-sendbackwards",this.sendBackwards,this),msg.on("submit-undo",this.colorUndo,this),$("#colorpicker-holder-text").ColorPicker({flat:!0,onChange:function(e,t,n,a){o.onColorChange(t)},onSubmit:function(e,t,n,a){$.isEmptyObject($canvas.getActiveObj())||o.onColorSelect(t)}}),$("#colorpicker-holder-text").hide(),$(".text-picker").keyup(function(){$(this).val("")}),$(".text-picker").click(function(e){$("#mlSelectedColorText").off(),$("#mlColors").off(),$(".colorpicker")[1].style.left=e.clientX.toString()+"px",$(".colorpicker")[1].style.top=e.clientY.toString()+"px",$(".colorpicker_undo")[1].style.display="none",$("#colorpicker-holder-text").show(),$("#mlSelectedColorText").keyup(function(){o.onColorChange(this.value)}),$("#mlColors").mouseleave(function(){var e=$canvas.getActiveDobj(),t=$canvas.getOriginColorByObj(e.raw,e.id)
Object.keys(t).length&&o.onColorChange(rgb2hex(t.fill))})})}return e.prototype.onObjectSelected=function(t){var o=this
if(this.$scope.visible=t.type==DOType.ITEXT,!this.$scope.visible)return $(".object-option").hide()
var n=t.raw.fill
0===$cmd.history.length&&!1===e.instance.primaryColorWasSet&&(e.instance.primaryColor=n,e.instance.primaryColorWasSet=!0),$("#id-bold-btn").removeClass("active"),$("#id-italic-btn").removeClass("active"),this.hasWeight(t)&&$("#id-bold-btn").addClass("active"),this.hasStyle(t)&&$("#id-italic-btn").addClass("active"),t.raw.fontFamily&&(this.$scope.font_name=t.raw.fontFamily.firstToUppercase().allReplace({_:" ","-":" "}))
var a=rgb2hex(t.raw.fill)
o.oldColor=a.substring(1),o.newColor=a.substring(1),a.indexOf("#")<0&&(a="#"+a),$("#colorpicker-holder-text").ColorPickerSetColor(a),$(".text-picker").css("background-color",a),$(".text-picker").val(""),$(".symbolcolor").hide(),$(".object-option").show(),$(".symbol-container .symbol-color ").hide(),$(".symbol-container .symbol-transparency").hide(),$(".symbol-container .title").hide(),$(".object-option .text-container").show()},e.prototype.onObjectDeSelected=function(e){this.$scope.visible=!1,$(".object-option").hide(),$("#colorpicker-holder-text").hide()},e.prototype.onColorChange=function(t){var o=(e.instance,$canvas.getActiveDobj());-1==t.indexOf("#")&&(t="#"+t),$(".text-picker").css("background-color",t),$(".text-picker").val(""),o.raw.fill=t,canvas.renderAll()},e.prototype.resetScaleButton=function(){var e=$("#id-plus-btn")
e.hasClass("input-active")&&e.removeClass("input-active")
var t=$("#id-minus-btn")
t.hasClass("input-active")&&t.removeClass("input-active")},e.prototype.scaleUp=function(e){var t=$canvas.getActiveObj(),o=t.width*t.getScaleX(),n=t.height*t.getScaleY(),a=t.getScaleX(),s=t.getScaleY(),i={x:a,y:s,t:t.top,l:t.left}
t.setScaleX(a+.1),t.setScaleY(s+.1)
var r=t.width*t.getScaleX(),l=t.height*t.getScaleY(),c=r-o,d=l-n
t.left-=c/2,t.top-=d/2
var p={x:t.getScaleX(),y:t.getScaleY(),t:t.top,l:t.left}
if("click"==e.type||"mousedown"==e.type){var h=$("#id-plus-btn")
h.hasClass("input-active")||this.protectclick||h.addClass("input-active"),this.protectclick=!1}else{var h=$("#id-plus-btn")
h.hasClass("input-active")&&h.removeClass("input-active"),this.protectclick=!0}$cmd.run("scale",t,i,p),t.setCoords()},e.prototype.scaleDown=function(e){var t=$canvas.getActiveObj(),o=t.width*t.getScaleX(),n=t.height*t.getScaleY(),a=t.getScaleX(),s=t.getScaleY(),i={x:a,y:s,t:t.top,l:t.left}
a-.1>t.minScaleLimit&&t.setScaleX(a-.1),s-.1>t.minScaleLimit&&t.setScaleY(s-.1)
var r=t.width*t.getScaleX(),l=t.height*t.getScaleY(),c=r-o,d=l-n
t.left-=c/2,t.top-=d/2
var p={x:t.getScaleX(),y:t.getScaleY(),t:t.top,l:t.left}
if("click"==e.type||"mousedown"==e.type){var h=$("#id-minus-btn")
h.hasClass("input-active")||this.protectclick||h.addClass("input-active"),this.protectclick=!1}else{var h=$("#id-minus-btn")
h.hasClass("input-active")&&h.removeClass("input-active"),this.protectclick=!0}$cmd.run("scale",t,i,p),t.setCoords()},e.prototype.onColorSelect=function(t){var o=e.instance,n=$canvas.getActiveDobj()
n.raw.fill
$(".colorpicker_undo")[1].style.display="block",o.oldColor=o.newColor,o.newColor=t
var a=rgb2hex($canvas.getOriginColorByObj(n.raw,n.id).fill)
!1===o.primaryColorWasStored?($cmd.run("text-color",n,o.primaryColor,t),o.primaryColorWasStored=!0):$cmd.run("text-color",n,a,t)},e.prototype.colorUndo=function(e){var t=this,o=$canvas.getActiveDobj()
if(null!=o){if(-1==t.oldColor.indexOf("#")&&(t.oldColor="#"+t.oldColor),$(".text-picker").css("background-color",t.oldColor),$(".text-picker").val(""),null==o.raw)return
o.raw.fill=t.oldColor,t.newColor=t.oldColor,$(".colorpicker_undo")[1].style.display="none",$("#colorpicker-holder-text").ColorPickerSetColor(t.oldColor)}},e.prototype.fontSelect=function(){this.$scope.font_name=$canvas.getActiveDobj().raw.fontFamily.firstToUppercase().allReplace({_:" ","-":" "})},e.prototype.fontWeight=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj())
$cmd.run("text-font-weight",t.raw.fontWeight,e)},e.prototype.fontStyle=function(e){var t=$.extend(!0,{},$canvas.getActiveDobj())
$cmd.run("text-font-style",t.raw.fontStyle,e)},e.prototype.hasWeight=function(e){return"normal"!=e.raw.fontWeight},e.prototype.hasStyle=function(e){if(e.raw.fontStyle)return e.raw.fontStyle.length},e.prototype.toggleFontBold=function(e){var t=$canvas.getActiveDobj(),o=$(e.currentTarget)
this.hasWeight(t)?(this.fontWeight("normal"),o.removeClass("input-active")):(this.fontWeight("bold"),o.addClass("input-active"))},e.prototype.toggleFontItalic=function(e){var t=$canvas.getActiveDobj(),o=$(e.currentTarget)
this.hasStyle(t)?(this.fontStyle(""),o.removeClass("input-active")):(this.fontStyle("italic"),o.addClass("input-active"))},e.prototype.toggleTransparency=function(){var e=$canvas.activePaths
$cmd.run("symbol-transparency",e)},e.prototype.onFontClick=function(){msg.send("open-popup","fontselection")},e.prototype.onColorClick=function(e){},e.prototype.sendBackwards=function(){var e=canvas.getActiveObject()
e.sendBackwards()
var t=canvas.getObjects().indexOf(e),o=0===t,n=t==canvas.getObjects().length-1
$("#id-zindex-buttonbar").show(),$("#id-sendbackwards-btn").prop("disabled",o),$("#id-bringforward-btn").prop("disabled",n),$("#send-backwards-btn").prop("disabled",o),$("#bring-forward-btn").prop("disabled",n)},e.prototype.bringForward=function(){var e=$canvas.getActiveObj()
e.bringForward()
var t=canvas.getObjects().indexOf(e)
$("#id-sendbackwards-btn").prop("disabled",0==t),$("#id-bringforward-btn").prop("disabled",t==canvas.getObjects().length-1),$("#bring-forward-btn").prop("disabled",t==canvas.getObjects().length-1),$("#send-backwards-btn").prop("disabled",0==t)},e}(),RenameController=function(e){function t(t){e.call(this,t),this.init("rename"),$cmd.map("rename",this.rename,this),$cmd.mapUndo("rename",this.undoRename),msg.on("open-rename",this.popupRename,this)}return __extends(t,e),t.prototype.rename=function(e,t,o){$canvas.rename(e,o)},t.prototype.undoRename=function(e,t,o){$canvas.rename(e,t)},t.prototype.popupRename=function(){this.$scope.newname=$canvas.getActiveDobj().name},t.prototype.onOkClick=function(){if(!isEmptyObj($canvas.getActiveDobj())){var e=$canvas.getActiveDobj()
if(this.$scope.newname.length>16)return alert("Sorry, more than: 16 not allowd.")
$cmd.run("rename",e,e.name,this.$scope.newname),this.close()}},t.prototype.onCancelClick=function(){this.close()},t}(PopupController),FeedbackController=function(){function e(t){e.instance=this,this.$scope=t,t.$=this,this.currentPage=0,this.currentQuestion=0}return e.prototype.startFeedBack=function(){this.currentPage=1,this.displayCurrentPage()},e.prototype.hoverStars=function(e){for(var t=0;t<=e;t++)$("#rating-star-"+t.toString()).css({color:"gold"}).removeClass("fa-star-o").addClass("fa-star")
for(var t=e+1;t<5;t++)$("#rating-star-"+t.toString()).css({color:"black"}).removeClass("fa-star").addClass("fa-star-o")},e.prototype.clickStars=function(e){var t="Rating Question: "+(e+1).toString(),o="Stars: "+(this.currentQuestion+1).toString()
ga("send","event","App Click",t,o),this.currentQuestion++,this.showQuestion()},e.prototype.showQuestion=function(){switch(this.currentQuestion){case 0:$("#feedback-question-text").text(Tools.translateText("feedback-question-1"))
break
case 1:$("#feedback-question-text").text(Tools.translateText("feedback-question-2"))
break
case 3:$("#feedback-question-text").text(Tools.translateText("feedback-question-3"))
break
case 4:this.currentPage=2,this.displayCurrentPage()
break
case 5:this.currentPage=3,this.displayCurrentPage()}},e.prototype.submitComment=function(){""!=$("#comments-text-area").val()&&ga("send","event","App Click","Comment Submitted",$("#comments-text-area").val()),this.currentPage=4,this.displayCurrentPage()},e.prototype.displayCurrentPage=function(){switch($("#feedback-initial-panel").hide(),$("#feedback-star-panel").hide(),$("#feedback-comments-panel").hide(),$("#feedback-thanks-panel").hide(),$("#feedback-question-with-text-panel").hide(),this.currentPage){case 0:this.showInitialPage()
break
case 1:this.showRatingPage()
break
case 2:this.showQuestionwithText()
break
case 3:this.showCommentsPage()
break
case 4:this.showThanksPage()}},e.prototype.showInitialPage=function(){$("#feedback-initial-panel").show()},e.prototype.resetFeedback=function(){this.currentPage=0,this.currentQuestion=0,this.displayCurrentPage()},e.prototype.showThanksPage=function(){$("#feedback-thanks-panel").show()},e.prototype.showQuestionwithText=function(){$("#feedback-question-with-text-panel").show()},e.prototype.submitAnswer=function(){""!=$("#answer-text-area").val()&&ga("send","event","App Click","Answer Submitted",$("#answer-text-area").val()),this.currentPage=3,this.displayCurrentPage()},e.prototype.showCommentsPage=function(){$("#feedback-comments-panel").show()},e.prototype.showRatingPage=function(){$("#feedback-star-panel").show(),this.showQuestion()},e.prototype.PageUp=function(){this.currentPage++},e.prototype.PageDown=function(){this.currentPage--},e}(),SymbolColorController=function(){function e(e){var t=this
this.$scope=e,this.textColor=0,this.oldColor="fff",this.newColor="fff",this.onColorChange=function(e){t.enabled()&&($(".color-picker").css("background-color","#"+e),$cmd.run("symbol-color",$canvas.getActiveDobj(),"#"+$canvas.activePathsColor.toHex().toLowerCase(),"#"+e),t.textColor=e)},ObjectsController.instance=this,e.$=this,e.visible=!1,e.pathsVisible=!0,msg.on("object-selected",this.onObjectSelected,this),msg.on("paths-selected",this.onObjectSelected,this),msg.on("object-deselected",this.onObjectDeSelected,this),msg.on("deselect-all",this.onObjectDeSelected,this),msg.on("submit-undo",this.colorUndo,this),$("#colorpicker-holder-symbol").ColorPicker({flat:!0,onSubmit:function(e,o,n,a){if(!$.isEmptyObject($canvas.getActiveObj())){t.oldColor=t.newColor,t.newColor=o,$(".colorpicker_undo")[0].style.display="block"
for(var s=$canvas.getActiveDobj(),i=$canvas.getActiveObj().getObjects(),r=$canvas.activePaths,l=0;l<i.length;l++)for(var c=0;c<r.length;c++)JSON.stringify(i[l])==JSON.stringify(r[c])&&$.extend(!0,{},$canvas.getOriginColorByObj(i[l],s.id.toString()+l.toString()))}},onShow:function(){$(this).ColorPickerSetColor("0000")},onBeforeShow:function(){$(this).ColorPickerSetColor("0000")},onChange:function(e,t,o,n){var a=this
if(!$.isEmptyObject($canvas.getActiveObj())){for(var s,i=$canvas.getActiveDobj(),r=$canvas.getActiveObj().getObjects(),l=$canvas.activePaths,c=0;c<r.length;c++)for(var d=0;d<l.length;d++)void 0===l[c]&&null!==l[c]||void 0!=l[d].fill&&($canvas.activeStrokeColor||l[d].fill=="#"+t&&(t=t.substr(0,t.length-1)+Tools.makeid(1))),JSON.stringify(r[c])==JSON.stringify(l[d])&&(s=$.extend(!0,{},$canvas.getOriginColorByObj(r[c],i.id.toString()+c.toString())),!1===$canvas.activeStrokeColor?$canvas.setFillColor(l[d],i.id.toString()+c.toString(),"#"+t):(void 0!==l[d].fill&&null!==l[d].fill&&$canvas.setFillColor(l[d],i.id.toString()+c.toString(),l[d].fill),void 0!==l[d].stroke&&null!==l[d].stroke&&$canvas.setStrokeColor(l[d],i.id.toString()+c.toString(),"#"+t)))
$(".color-picker").css("background-color","#"+t),!1===$canvas.activeStrokeColor&&$cmd.run("symbol-color",$canvas.getActiveDobj(),s.fill,"#"+t),a.textColor=t}}}),$("#colorpicker-holder-symbol").hide(),$(".color-picker").keyup(function(){$(this).val("")}),$(".color-picker").click(function(e){$(".colorpicker")[0].style.left=e.clientX.toString()+"px",$(".colorpicker")[0].style.top=e.clientY.toString()+"px",$(".colorpicker_undo")[0].style.display="none",$("#colorpicker-holder-symbol").show(),$("#mlSelectedColorText").off(),$("#mlColors").off(),$canvas.reSetVisibilityGroup(),window.cancelRequestAnimFrame(window.renderAnimationFrame),window.colorpicker.controller="SymbolColorController",window.colorpicker.visible=!0,msg.send("remove-opacity-all")
var t=function(e){var t=this,o=t.value,n="#"+o,a={},s=/^[a-fA-F0-9]{6}|[a-fA-F0-9]{3}$/
if(13==e.keyCode&&$("#mlColorPicker").hide().removeData("mlOnChange"),o.match(s)&&(3==o.length||6==o.length)){if(!1!==$canvas.activeStrokeColor)for(var i=0;i<$canvas.activePaths.length;i++)a=$canvas.activePaths[i],a.getStroke()&&$canvas.pathStrokeColor(a,a.getStroke(),n),$canvas.activePaths[i].fill.toLowerCase()==$canvas.activeStrokeColor&&(a=$canvas.activePaths[i],$canvas.pathFillColor(a,a.fill,n),$canvas.activeStrokeColor=n)
else $canvas.symbolColor($canvas.getActiveDobj(),$canvas.activePaths[0].fill,n)
$("#mlSelectedColorDiv").css("background-color","#"+o),$(".color-picker").css("background-color","#"+o)}},o=function(){for(var e=$canvas.getActiveDobj(),t=$canvas.getActiveObj().getObjects(),o=$canvas.activePaths,n=0;n<t.length;n++)for(var a=0;a<o.length;a++)if(JSON.stringify(t[n])==JSON.stringify(o[a])){var s=$canvas.getOriginColorByObj(t[n],e.id.toString()+n.toString())
!1===$canvas.activeStrokeColor?(void 0!==s.fill&&(0!==s.fill.length&&null!==s.fill||(s.fill="#000")),t[n].setFill(s.fill)):(void 0!==s.stroke&&(0!==s.stroke.length&&null!==s.stroke||(s.stroke="#000")),t[n].setStroke(s.stroke))}}
$("#mlSelectedColorText").on("keyup",t),$("#mlColors").on("mouseleave",o)})}return e.prototype.enabled=function(e){return 0===$canvas.selection.length&&$canvas.selection.push(e),$canvas.selection[0].type==DOType.SYMBOL},e.prototype.colorUndo=function(e){var t=this
t.newColor=t.oldColor,$(".colorpicker_undo")[0].style.display="none",$("#colorpicker-holder-symbol").ColorPickerSetColor(t.oldColor)
if(!$.isEmptyObject($canvas.getActiveObj())&&$canvas.getActiveObj().hasOwnProperty("paths")){for(var o,e=$canvas.getActiveDobj(),n=$canvas.getActiveObj().getObjects(),a=$canvas.activePaths,s=0;s<n.length;s++)for(var i=0;i<a.length;i++)JSON.stringify(n[s])==JSON.stringify(a[i])&&(o=$.extend(!0,{},$canvas.getOriginColorByObj(n[s],e.id.toString()+s.toString())),!1===$canvas.activeStrokeColor?$canvas.setFillColor(a[i],e.id.toString()+s.toString(),"#"+t.oldColor):(void 0!==a[i].fill&&null!==a[i].fill&&$canvas.setFillColor(a[i],e.id.toString()+s.toString(),a[i].fill),void 0!==a[i].stroke&&null!==a[i].stroke&&$canvas.setStrokeColor(a[i],e.id.toString()+s.toString(),"#"+t.oldColor)))
$(".color-picker").css("background-color","#"+t.oldColor),!1===$canvas.activeStrokeColor&&$cmd.run("symbol-color",$canvas.getActiveDobj(),o.fill,"#"+t.oldColor),t.textColor=t.oldColor,$cmd.run("symbol-color",$canvas.getActiveDobj(),o.fill,"#"+t.oldColor)}},e.prototype.onObjectSelected=function(e){var t=this
if((e.type==DOType.IMAGE||e.type==DOType.SYMBOL)&&null!==e&&void 0!==e){msg.send("clear-action-buttons"),this.onObjectDeSelected(),this.$scope.pathsVisible=!0,this.$scope.visible=this.enabled(e),e.type==DOType.SYMBOL&&(t.oldColor=$canvas.activePathsColor.toHex().toLowerCase(),t.newColor=$canvas.activePathsColor.toHex().toLowerCase(),$("#colorpicker-holder-symbol").ColorPickerSetColor($canvas.activePathsColor.toHex().toLowerCase()),$(".color-picker").css("background-color","#"+$canvas.activePathsColor.toHex().toLowerCase()))
for(var o=$canvas.activePaths,n=0;n<o.length;n++)o[n].hasOwnProperty("invisible")&&o[n].invisible&&(this.$scope.pathsVisible=!1)
canvas.getObjects().length>1&&($(".object-option").show(),$(".title").show(),e.isCard?$(".title").text("CARD OPTIONS"):$(".title").text(Tools.translateText("symbol-options-text")),$("#colorpicker-holder-symbol").hide(),$(".object-option .text-container").hide())
var a=0
if($canvas.activePaths.length>0){a=e.type==DOType.SYMBOL?e.raw.paths.length:0
var s=$canvas.activePaths[0]
s.hasOwnProperty("invisible")&&s.invisible?$("#transparency-eye").removeClass("fa fa-eye").addClass("fa fa-eye-slash"):$("#transparency-eye").removeClass("fa fa-eye-slash").addClass("fa fa-eye"),this.$scope.visible&&($(".object-option").show(),$(".title").show(),s.invisible||$(".symbol-container .symbol-color").show(),a>1&&$(".symbol-container .symbol-transparency").show(),$(".object-option .text-container").hide())}}},e.prototype.onObjectDeSelected=function(){$(".object-option").hide(),$(".symbol-container .symbol-color").hide(),$("#colorpicker-holder-symbol").hide(),$(".symbol-container .symbol-transparency").hide(),this.$scope.visible=!1},e.prototype.onFontClick=function(){msg.send("open-popup","fontselection")},e.prototype.onInvisibleClick=function(e){this.$scope.pathsVisible=!this.$scope.pathsVisible,$cmd.run("symbol-visibility",$canvas.activePaths)},e}(),WelcomeController=function(){function e(e,t){this.$scope=e,this.visible=!0,e.$=this,this.lInstance=new LoginController(e,t,this),msg.on("init-project",this.init,this)}return e.prototype.open=function(){this.$scope.visible=!0,this.$scope.text=""},e.prototype.onOkClick=function(){this.visible=!1,msg.send("close-popups")},e.prototype.loadProject=function(e,t){var o=this.lInstance
if(!window.randomProject){var n=Math.floor(13*Math.random())
window.randomProject=n.toString()}window.showresources||$("#resources").hide()
var a="local_projects/json/default_"+window.randomProject+".olmn?v=0.002"
ga("send","event","App Click","Visitor","New visitor"),window.loadSample=e,o=e?this.lInstance.fakeLoginPromise():this.lInstance.loginPromise(),o.then(function(){setTimeout(function(){is_clone=!1,shadow="",x=50,y=50
var o=Tools.getQueryParameters("project")
if(o&&"p"!=o[0]){var n=Math.floor(1e5+9e5*Math.random())
$.ajax({method:"POST",url:"https://www.onlinelogomaker.com/version2_scripts/getversion2path.php?userid="+o,async:!1}).done(function(e){var t=JSON.parse(e)
a="https://www.onlinelogomaker.com/"+t.path+"/projects/"+o+".olmn?v="+n.toString()}).fail(function(){console.log("Image wasn't saved")})}else e?window.defaultproject=!0:a="https://www.onlinelogomaker.com/applet_userdata/"+window.user.id+"/projects/"+t
window.projectDataUrl=a,$.get(a,function(t,o){canvas.clear()
var n=JSON.parse(t)
n.bgColor&&($oCanvasColor.previous=$oCanvasColor.current,$oCanvasColor.current="fff",$cmd.run("background-color",$oCanvasColor.current,$oCanvasColor.current)),canvas.loadFromJSON(n,function(){objects=canvas.getObjects()
for(var t=0;t<objects.length;t++){var o=new DisplayObject
$canvas.idIndex++,o.id=t,o.name="OBJECT"+t,o.selected=!0,o.color="",o.raw=objects[t],o.shadow={enabled:!1,color:"#000",blur:5,offsetX:9.84807753012208,offsetY:1.7364817766693033,direction:10,outset:10,opacity:.6,fillShadow:!0,strokeShadow:!0},o.glow={enabled:!1,color:"rgba(0,0,0,0.6)",blur:40,offsetX:0,offsetY:0,opacity:.6,fillShadow:!0,strokeShadow:!0},"path-group"==objects[t].type&&(type=DOType.SYMBOL),"text"==objects[t].type&&(type=DOType.TEXT),"i-text"==objects[t].type&&(type=DOType.ITEXT,o.font=n.objects[t].fontFamily),"image"==objects[t].type&&(type=DOType.IMAGE),o.type=type,$canvas.children.unshift(o)}var a={},s={},i={}
for(t=0;t<$canvas.children.length;t++)if(a={},i=$canvas.children[t],a.id=i.id,a.fill=i.raw.fill,a.stroke=i.raw.stroke,a.shadow=i.raw.shadow,a.raw=JSON.stringify(i.raw),$oColors.push(a),i.type==DOType.SYMBOL){s=i.raw.getObjects()
for(var r=0;r<s.length;r++)a={},a.id=i.id.toString()+r.toString(),a.fill=s[r].fill,a.stroke=s[r].stroke,a.shadow=i.shadow,a.raw=JSON.stringify(s[r]),$oColors.push(a)}var l=$(".leftpane").width(),c=$(".topPane").height(),d=canvas.height-c,p=canvas.width-l
$canvas.selectAll()
var h=d/canvas.getActiveGroup().height,g=p/canvas.getActiveGroup().width,m=canvas.getActiveGroup().height,u=canvas.getActiveGroup().width
do{(h<1||g<1)&&(canvas.getActiveGroup().scaleY*=.8,canvas.getActiveGroup().scaleX*=.8,m*=.8,u*=.8),h=d/u,g=p/u}while(h<1||g<1)
if(canvas.getActiveGroup().left=(p+2*l)/2,canvas.getActiveGroup().top=(d+2*c)/2,canvas.deactivateAllWithDispatch().renderAll(),msg.send("deselect-all"),msg.send("project-loaded"),e){var v=Tools.getQueryParameters("wiz"),f=!!window.chrome&&!!window.chrome.webstore,w=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0
"1"==v&&(f||w)&&(setTimeout(function(){msg.send("activate-guided-tour")},2e3),$("#olm-guided-tour-container").css("display","block"))}})})},600)})},e.prototype.init=function(){var e=getQueryVariable("project")
if(e)return this.loadProject(loadSample=!1,e),null
this.loadProject(loadSample=!0)},e}(),InitController=function(){function e(e,t){this.htmlAppContainer=$(".logomaker.container"),this.htmlWelcomeModal=$("#welcome-modal"),window.onbeforeunload=function(){return"Do you really want to close?"},this.lInstance=new LoginController(e,t,this),this.init()}return e.prototype.welcomeModal=function(){var e=this
e.htmlWelcomeModal.fadeIn("slow"),setTimeout(function(){e.htmlWelcomeModal.fadeOut("slow")},6e3)},e.prototype.createLoginPromise=function(){this.lInstance.loginPromise()},e.prototype.init=function(){var e=this
Tools.getQueryParameters("p")
$(window).load(function(){Tools.initPaypal(),Tools.translatePageInit(),$.ajax({method:"POST",url:"jsconfig.php",async:!1}).done(function(e){var t=JSON.parse(e)
t.showResources
window.showresources=t.showResources,window.downloadUrl=t.downloadUrl,window.skip=t.skipPremium,window.emailTemaplateIndex=t.emailTemplateIndex,window.live_chat=t.live_chat,window.homeUrl=t.homeUrl,window.live_chat||$("#welcome-modal").css("opacity","0"),window.showresources||($("#proper-credi-text").hide(),$("#paste-code-container").hide(),$("#resources").hide()),$("#logoImage").attr("src","img/"+t.logoName),"logomaker.thehoth.com"==t.downloadUrl&&$(".navbar-header").css("padding-top","0px")}).fail(function(){console.log("Image wasn't saved")})}),$("#downloadLogo-modal").css("width","702px"),$("#preview-download-canvas").css("width","702px"),$("#preview-download-canvas").css("height","206px"),$("#preview-download-canvas").css("background","url(assets/images/previewimg.jpg?v=0.121)"),$("#downloadLogo-modal").css("left","31%"),$("#top-panel").bind("touchmove",function(e){e.preventDefault()})
var t=Math.floor(3*Math.random())+1
1==t?($("#olm-become-premium-button").css("border-color","rgb(26, 188, 156)"),$("#olm-become-premium-button").css("color","rgb(255, 255, 255)"),$("#olm-become-premium-button").css("line-height","18.5px"),$("#olm-become-premium-button").css("white-space","nowrap")):2==t?($("#olm-become-premium-button").css("border-color","rgb(255, 255, 255)"),$("#olm-become-premium-button").css("color","rgb(255, 255, 255)"),$("#olm-become-premium-button").css("border-radius","10px")):3==t&&($("#olm-become-premium-button").css("background-color","rgb(33, 41, 47)"),$("#olm-become-premium-button").css("color","#1abc9c"),$("#olm-become-premium-button").css("border-style","outset"))
var o=function(){return"undefined"!=typeof G_vmlCanvasManager}
fabric.util.object.extend(fabric.Object.prototype,{hasRotatingPoint:!0,selectedIconImage:new Image,iconSrc:"img/arrows.png",isLoaded:!1,_drawControl:function(e,t,n,a,s){var i=this,r=this.cornerSize
i.selectedIconImage.crossOrigin="Anonymous",i.isControlVisible(e)&&(o()||i.transparentCorners||t.clearRect(a,s,2*r,2*r),"mtr"===e?i.isLoaded?t.drawImage(i.selectedIconImage,a-3,s-3,18,18):(i.selectedIconImage.onload=function(){i.isLoaded=!0,t.drawImage(this,a-3,s-3,18,18),canvas.renderAll()},i.selectedIconImage.src=i.iconSrc):t.strokeRect(a,s,r,r))}}),$(document).bind("touchend",function(e){window.scrollTo(0,0)}),$(window).load(function(){$("#preloader").remove()
var t=Tools.getQueryParameters("project")
""!=t?(Tools.createCookie("userguestid",t,260),$("#test-id").text(Tools.getCookie("userguestid"))):Tools.createCookie("userguestid","",260),e.htmlAppContainer.fadeIn("slow",function(){switch(setInterval(function(){null!==canvas.getActiveObject()&&void 0!==canvas.getActiveObject()||msg.send("clear-action-buttons")},1e3),e.welcomeModal(),parseInt(getQueryVariable("v"))){case 1:msg.send("open-symbols")
break
case 2:msg.send("activate-guided-tour")
break
default:var t=Math.floor(13*Math.random())
window.randomProject=t.toString()
var o="local_projects/json/default_"+window.randomProject+".olmn?v=0.002",n=getQueryVariable("project"),a=!n
loginPromise=a?e.lInstance.fakeLoginPromise():e.lInstance.loginPromise(),loginPromise.then(function(){setTimeout(function(){var e=Tools.getQueryParameters("project")
if(e&&"p"!=e[0]){var t=Math.floor(1e5+9e5*Math.random())
$.ajax({method:"POST",url:"https://www.onlinelogomaker.com/version2_scripts/getversion2path.php?userid="+e,async:!1}).done(function(n){var a=JSON.parse(n)
o="https://www.onlinelogomaker.com/"+a.path+"/projects/"+e+".olmn?v="+t.toString(),$.get(o,function(e,t){canvas.clear()
var o=JSON.parse(e)
for(i=0;i<o.objects.length;i++)"i-text"==o.objects[i].type&&(text=new fabric.IText("Logo Maker",{fontFamily:o.objects[i].fontFamily,fontSize:2,padding:0}),msg.send("add",$canvas.create(DOType.ITEXT,text),!1,-100,-100))
setTimeout(function(){msg.send("init-project")},1)})}).fail(function(){console.log("Image wasn't saved")})}else a?$.get(o,function(e,t){canvas.clear()
var o=JSON.parse(e)
for(i=0;i<o.objects.length;i++)"i-text"==o.objects[i].type&&(text=new fabric.IText("Logo Maker",{fontFamily:o.objects[i].fontFamily,fontSize:2,padding:0}),msg.send("add",$canvas.create(DOType.ITEXT,text),!1,-100,-100))
setTimeout(function(){msg.send("init-project")},1)}):o="https://www.onlinelogomaker.com/applet_userdata/"+window.user.id+"/projects/"+n},1)})}})})},e}()
